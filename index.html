<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CA1 Revision - Consumer & Market Studies | ESSCA</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“š</text></svg>">
<style>
/* ===== CSS VARIABLES & RESET ===== */
:root {
  --primary: #e30613;
  --primary-dark: #b00510;
  --primary-light: #ff4d5a;
  --bg: #f0f2f5;
  --bg-card: #ffffff;
  --bg-card-alt: #f8f9fa;
  --text: #1a1a2e;
  --text-secondary: #6c757d;
  --text-light: #adb5bd;
  --border: #e9ecef;
  --shadow: 0 4px 24px rgba(0,0,0,0.06);
  --shadow-hover: 0 8px 32px rgba(0,0,0,0.12);
  --radius: 16px;
  --radius-sm: 10px;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --gradient: linear-gradient(135deg, #e30613 0%, #ff6b6b 50%, #e30613 100%);
  --gradient-dark: linear-gradient(135deg, #b00510 0%, #e30613 100%);
  --success: #10b981;
  --success-bg: #ecfdf5;
  --error: #ef4444;
  --error-bg: #fef2f2;
  --warning: #f59e0b;
  --warning-bg: #fffbeb;
  --info: #3b82f6;
  --info-bg: #eff6ff;
}

[data-theme="dark"] {
  --bg: #0f172a;
  --bg-card: #1e293b;
  --bg-card-alt: #253349;
  --text: #e2e8f0;
  --text-secondary: #94a3b8;
  --text-light: #64748b;
  --border: #334155;
  --shadow: 0 4px 24px rgba(0,0,0,0.3);
  --shadow-hover: 0 8px 32px rgba(0,0,0,0.5);
  --success-bg: #064e3b;
  --error-bg: #450a0a;
  --warning-bg: #451a03;
  --info-bg: #1e3a5f;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.7;
  transition: var(--transition);
  overflow-x: hidden;
}

/* ===== SCROLLBAR ===== */
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 4px; }

/* ===== HEADER ===== */
.hero {
  background: var(--gradient);
  background-size: 200% 200%;
  animation: gradientShift 8s ease infinite;
  color: white;
  padding: 60px 30px 80px;
  text-align: center;
  position: relative;
  overflow: hidden;
}
@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}
.hero::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
  animation: pulse 4s ease-in-out infinite;
}
@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 0.5; }
  50% { transform: scale(1.1); opacity: 0.8; }
}
.hero h1 {
  font-size: 2.8em;
  font-weight: 800;
  letter-spacing: -1px;
  margin-bottom: 8px;
  position: relative;
  text-shadow: 0 2px 10px rgba(0,0,0,0.2);
}
.hero .subtitle {
  font-size: 1.2em;
  opacity: 0.95;
  font-weight: 400;
  margin-bottom: 20px;
  position: relative;
}
.exam-badge {
  display: inline-flex;
  align-items: center;
  gap: 12px;
  background: rgba(255,255,255,0.2);
  backdrop-filter: blur(10px);
  padding: 14px 28px;
  border-radius: 50px;
  font-size: 0.95em;
  font-weight: 500;
  position: relative;
  border: 1px solid rgba(255,255,255,0.3);
}
.exam-badge span { display: flex; align-items: center; gap: 6px; }
.badge-dot {
  width: 4px; height: 4px;
  background: rgba(255,255,255,0.6);
  border-radius: 50%;
}

/* ===== CONTROLS BAR ===== */
.controls-bar {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--bg-card);
  border-bottom: 1px solid var(--border);
  padding: 12px 24px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  transition: var(--transition);
  flex-wrap: wrap;
}
.controls-left {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
  min-width: 0;
}
.controls-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

/* Search */
.search-box {
  position: relative;
  flex: 1;
  max-width: 400px;
}
.search-box input {
  width: 100%;
  padding: 10px 16px 10px 42px;
  border: 2px solid var(--border);
  border-radius: 50px;
  background: var(--bg);
  color: var(--text);
  font-size: 0.9em;
  transition: var(--transition);
  outline: none;
}
.search-box input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(227,6,19,0.15); }
.search-box svg {
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  width: 18px;
  height: 18px;
  color: var(--text-light);
}

/* Progress */
.progress-container {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.85em;
  color: var(--text-secondary);
  white-space: nowrap;
}
.progress-bar {
  width: 120px;
  height: 6px;
  background: var(--border);
  border-radius: 3px;
  overflow: hidden;
}
.progress-fill {
  height: 100%;
  background: var(--gradient);
  border-radius: 3px;
  transition: width 0.5s ease;
  width: 0%;
}

/* Theme toggle */
.theme-toggle {
  width: 42px;
  height: 24px;
  background: var(--border);
  border-radius: 12px;
  border: none;
  cursor: pointer;
  position: relative;
  transition: var(--transition);
}
.theme-toggle::after {
  content: '';
  position: absolute;
  width: 18px;
  height: 18px;
  background: white;
  border-radius: 50%;
  top: 3px;
  left: 3px;
  transition: var(--transition);
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
[data-theme="dark"] .theme-toggle { background: var(--primary); }
[data-theme="dark"] .theme-toggle::after { left: 21px; }

/* ===== NAV TABS ===== */
.nav-tabs {
  display: flex;
  gap: 4px;
  padding: 12px 24px;
  background: var(--bg-card);
  border-bottom: 1px solid var(--border);
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.nav-tabs::-webkit-scrollbar { display: none; }
.nav-tab {
  padding: 8px 18px;
  border-radius: 50px;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-size: 0.85em;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  white-space: nowrap;
  position: relative;
}
.nav-tab:hover { background: var(--bg); color: var(--text); }
.nav-tab.active {
  background: var(--primary);
  color: white;
  box-shadow: 0 2px 8px rgba(227,6,19,0.3);
}

/* ===== MODE SWITCHER ===== */
.mode-switcher {
  display: flex;
  justify-content: center;
  gap: 8px;
  padding: 20px 24px 0;
}
.mode-btn {
  padding: 12px 28px;
  border-radius: var(--radius-sm);
  border: 2px solid var(--border);
  background: var(--bg-card);
  color: var(--text-secondary);
  font-size: 0.95em;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
}
.mode-btn:hover { border-color: var(--primary); color: var(--primary); }
.mode-btn.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
  box-shadow: 0 4px 16px rgba(227,6,19,0.3);
}

/* ===== MAIN CONTAINER ===== */
.container {
  max-width: 960px;
  margin: 0 auto;
  padding: 24px;
}

/* ===== SECTIONS ===== */
.section {
  display: none;
}
.section.active {
  display: block;
  animation: fadeIn 0.4s ease;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== SESSION CARD ===== */
.session-card {
  background: var(--bg-card);
  border-radius: var(--radius);
  margin: 20px 0;
  box-shadow: var(--shadow);
  overflow: hidden;
  transition: var(--transition);
  border: 1px solid var(--border);
}
.session-card:hover {
  box-shadow: var(--shadow-hover);
  transform: translateY(-2px);
}
.session-header {
  padding: 20px 28px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  user-select: none;
}
.session-header:hover { background: var(--bg-card-alt); }
.session-number {
  width: 44px;
  height: 44px;
  background: var(--gradient);
  color: white;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  font-size: 1.1em;
  flex-shrink: 0;
}
.session-info { flex: 1; }
.session-info h3 {
  font-size: 1.1em;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 2px;
}
.session-info p {
  font-size: 0.85em;
  color: var(--text-secondary);
}
.session-toggle {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--bg);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  flex-shrink: 0;
}
.session-card.open .session-toggle { transform: rotate(180deg); }
.session-body {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}
.session-card.open .session-body { max-height: 5000px; }
.session-content { padding: 0 28px 24px; }

/* ===== CONCEPT CARD ===== */
.concept {
  padding: 18px 20px;
  margin: 12px 0;
  background: var(--bg-card-alt);
  border-radius: var(--radius-sm);
  border-left: 4px solid var(--primary);
  transition: var(--transition);
}
.concept:hover { transform: translateX(4px); }
.concept-title {
  font-weight: 700;
  font-size: 1em;
  color: var(--primary);
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.concept p, .concept span { font-size: 0.95em; line-height: 1.7; }

/* ===== PROCESS FLOW ===== */
.process-flow {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
  margin: 10px 0;
}
.process-step {
  background: var(--gradient);
  color: white;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 0.88em;
  font-weight: 600;
  box-shadow: 0 2px 8px rgba(227,6,19,0.2);
}
.process-arrow { color: var(--primary); font-weight: bold; font-size: 1.3em; }

/* ===== TABLES ===== */
.table-wrap { overflow-x: auto; margin: 14px 0; border-radius: var(--radius-sm); }
table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
th {
  background: var(--gradient);
  color: white;
  padding: 12px 16px;
  text-align: left;
  font-weight: 600;
}
td {
  padding: 10px 16px;
  border-bottom: 1px solid var(--border);
  color: var(--text);
}
tr:nth-child(even) td { background: var(--bg-card-alt); }
tr:hover td { background: rgba(227,6,19,0.04); }

/* ===== TIP BOX ===== */
.tip {
  background: var(--warning-bg);
  border-left: 4px solid var(--warning);
  padding: 14px 18px;
  margin: 14px 0;
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
  font-size: 0.92em;
  font-weight: 500;
}

/* ===== KEY TERM ===== */
.key-term {
  display: inline-block;
  background: rgba(227,6,19,0.1);
  color: var(--primary);
  padding: 2px 10px;
  border-radius: 6px;
  font-weight: 700;
  font-size: 0.9em;
}

/* ===== CHEAT SHEET ===== */
.cheat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 16px;
  margin-top: 16px;
}
.cheat-card {
  background: var(--bg-card);
  border: 2px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 20px;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}
.cheat-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 4px;
  background: var(--gradient);
}
.cheat-card:hover {
  border-color: var(--primary);
  box-shadow: 0 4px 20px rgba(227,6,19,0.12);
  transform: translateY(-3px);
}
.cheat-card h4 {
  font-size: 0.95em;
  color: var(--primary);
  margin-bottom: 10px;
  font-weight: 700;
}
.cheat-card p {
  font-size: 0.88em;
  line-height: 1.6;
  color: var(--text-secondary);
}
.cheat-card strong { color: var(--text); }

/* ===== FLASHCARD MODE ===== */
.flashcard-container {
  perspective: 1200px;
  max-width: 600px;
  margin: 30px auto;
}
.flashcard {
  width: 100%;
  min-height: 300px;
  position: relative;
  cursor: pointer;
  transform-style: preserve-3d;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}
.flashcard.flipped { transform: rotateY(180deg); }
.flashcard-face {
  position: absolute;
  width: 100%;
  min-height: 300px;
  backface-visibility: hidden;
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 36px;
  text-align: center;
  box-shadow: var(--shadow);
  border: 2px solid var(--border);
}
.flashcard-front {
  background: var(--bg-card);
}
.flashcard-front h3 {
  font-size: 1.4em;
  color: var(--primary);
  margin-bottom: 12px;
}
.flashcard-front p {
  font-size: 0.9em;
  color: var(--text-light);
}
.flashcard-back {
  background: var(--gradient);
  color: white;
  transform: rotateY(180deg);
}
.flashcard-back p {
  font-size: 1.05em;
  line-height: 1.8;
}
.flashcard-controls {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-top: 24px;
}
.fc-btn {
  padding: 12px 32px;
  border-radius: 50px;
  border: 2px solid var(--border);
  background: var(--bg-card);
  color: var(--text);
  font-size: 0.95em;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
}
.fc-btn:hover { border-color: var(--primary); color: var(--primary); }
.fc-btn.primary-btn {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}
.fc-btn.primary-btn:hover { background: var(--primary-dark); }
.flashcard-progress {
  text-align: center;
  margin-top: 16px;
  font-size: 0.9em;
  color: var(--text-secondary);
  font-weight: 600;
}
.fc-session-badge {
  position: absolute;
  top: 12px;
  left: 14px;
  background: var(--primary);
  color: white;
  font-size: 0.7em;
  font-weight: 800;
  padding: 3px 10px;
  border-radius: 20px;
  z-index: 2;
  letter-spacing: 0.5px;
}
.fc-mastery-row {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-top: 14px;
}
.fc-mastery-btn {
  padding: 10px 24px;
  border-radius: 50px;
  border: 2px solid var(--border);
  background: var(--bg-card);
  color: var(--text);
  font-size: 0.85em;
  font-weight: 700;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 6px;
}
.fc-mastery-btn.got-it { border-color: var(--success); color: var(--success); }
.fc-mastery-btn.got-it:hover { background: var(--success); color: white; }
.fc-mastery-btn.review { border-color: var(--error); color: var(--error); }
.fc-mastery-btn.review:hover { background: var(--error); color: white; }
.fc-mastery-counter {
  text-align: center;
  margin-top: 10px;
  font-size: 0.85em;
  color: var(--text-secondary);
  font-weight: 600;
}
.fc-filter-btn.mastered-filter { border-color: var(--success); color: var(--success); }
.fc-filter-btn.mastered-filter.active { background: var(--success); color: white; border-color: var(--success); }

/* ===== EXAM TIPS ===== */
.tips-section {
  display: grid;
  gap: 20px;
}
.tip-card {
  background: var(--bg-card);
  border-radius: var(--radius);
  padding: 24px 28px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
}
.tip-card h4 {
  font-size: 1.1em;
  margin-bottom: 12px;
  color: var(--primary);
}
.tip-card ul {
  padding-left: 20px;
  line-height: 2;
}
.tip-card li { color: var(--text); }
.trap-item { background: var(--warning-bg); border-radius: var(--radius-sm); padding: 10px 14px; margin-bottom: 8px; }
.trap-item strong { color: var(--warning); }

/* ===== BACK TO TOP ===== */
.back-to-top {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: var(--primary);
  color: white;
  border: none;
  font-size: 1.3em;
  cursor: pointer;
  box-shadow: var(--shadow-hover);
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  z-index: 999;
}
.back-to-top.visible { opacity: 1; pointer-events: auto; }
.back-to-top:hover { transform: translateY(-3px); }

/* ===== PRINT ===== */
@media print {
  .hero, .controls, .mode-buttons, .footer, .back-to-top, #navTabs { display: none !important; }
  .section { display: block !important; opacity: 1 !important; }
  .cheat-card { break-inside: avoid; border: 1px solid #ccc; }
  body { background: white; color: black; }
}

/* ===== QUIZ MODE ===== */
.quiz-header {
  background: var(--bg-card);
  border-radius: var(--radius);
  padding: 24px 28px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 16px;
}
.quiz-score {
  display: flex;
  align-items: center;
  gap: 16px;
}
.score-circle {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: conic-gradient(var(--primary) 0%, var(--border) 0%);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}
.score-circle::before {
  content: '';
  width: 50px;
  height: 50px;
  background: var(--bg-card);
  border-radius: 50%;
  position: absolute;
}
.score-text {
  position: relative;
  z-index: 1;
  font-weight: 800;
  font-size: 0.85em;
  color: var(--primary);
}
.quiz-info h3 { font-size: 1.1em; font-weight: 700; }
.quiz-info p { font-size: 0.85em; color: var(--text-secondary); }
.quiz-actions { display: flex; gap: 10px; }
.quiz-btn {
  padding: 10px 22px;
  border-radius: 50px;
  border: none;
  font-size: 0.9em;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
}
.quiz-btn.reset-btn {
  background: var(--bg);
  color: var(--text-secondary);
  border: 2px solid var(--border);
}
.quiz-btn.reset-btn:hover { border-color: var(--primary); color: var(--primary); }

.question-card {
  background: var(--bg-card);
  border-radius: var(--radius);
  padding: 24px 28px;
  margin: 14px 0;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  transition: var(--transition);
}
.question-card.answered-correct { border-color: var(--success); }
.question-card.answered-wrong { border-color: var(--error); }
.question-num {
  font-size: 0.8em;
  font-weight: 700;
  color: var(--primary);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
}
.question-text {
  font-size: 1.05em;
  font-weight: 600;
  margin-bottom: 16px;
  line-height: 1.5;
}
.option {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  margin: 6px 0;
  border-radius: var(--radius-sm);
  border: 2px solid var(--border);
  cursor: pointer;
  transition: var(--transition);
  font-size: 0.95em;
}
.option:hover:not(.disabled) {
  border-color: var(--primary);
  background: rgba(227,6,19,0.04);
}
.option.selected {
  border-color: var(--primary);
  background: rgba(227,6,19,0.08);
}
.option.correct {
  border-color: var(--success);
  background: var(--success-bg);
}
.option.wrong {
  border-color: var(--error);
  background: var(--error-bg);
}
.option.disabled { cursor: default; opacity: 0.7; }
.option-letter {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: var(--bg);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.85em;
  flex-shrink: 0;
  transition: var(--transition);
}
.option.correct .option-letter { background: var(--success); color: white; }
.option.wrong .option-letter { background: var(--error); color: white; }
.explanation {
  margin-top: 14px;
  padding: 14px 18px;
  border-radius: var(--radius-sm);
  font-size: 0.9em;
  font-weight: 500;
  display: none;
  animation: fadeIn 0.3s ease;
}
.explanation.show { display: block; }
.explanation.correct-exp { background: var(--success-bg); color: #065f46; border-left: 4px solid var(--success); }
.explanation.wrong-exp { background: var(--error-bg); color: #991b1b; border-left: 4px solid var(--error); }
[data-theme="dark"] .explanation.correct-exp { color: #6ee7b7; }
[data-theme="dark"] .explanation.wrong-exp { color: #fca5a5; }

/* ===== QUIZ RESULTS ===== */
.quiz-results {
  display: none;
  text-align: center;
  padding: 48px 24px;
}
.quiz-results.show { display: block; animation: fadeIn 0.5s ease; }
.results-circle {
  width: 160px;
  height: 160px;
  border-radius: 50%;
  margin: 0 auto 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.8em;
  font-weight: 800;
  position: relative;
}
.results-circle.great { background: var(--success-bg); color: var(--success); border: 4px solid var(--success); }
.results-circle.ok { background: var(--warning-bg); color: var(--warning); border: 4px solid var(--warning); }
.results-circle.bad { background: var(--error-bg); color: var(--error); border: 4px solid var(--error); }
.results-msg { font-size: 1.4em; font-weight: 700; margin-bottom: 8px; }
.results-sub { color: var(--text-secondary); margin-bottom: 24px; }

/* ===== FOOTER ===== */
.footer {
  text-align: center;
  padding: 40px 24px;
  color: var(--text-light);
  font-size: 0.85em;
  border-top: 1px solid var(--border);
  margin-top: 40px;
}
.footer span { color: var(--primary); font-weight: 600; }

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .hero { padding: 40px 20px 60px; }
  .hero h1 { font-size: 1.8em; }
  .controls-bar { padding: 10px 16px; }
  .container { padding: 16px; }
  .session-content { padding: 0 20px 20px; }
  .mode-switcher { flex-wrap: wrap; }
  .cheat-grid { grid-template-columns: 1fr; }
  .exam-badge { flex-wrap: wrap; justify-content: center; font-size: 0.85em; padding: 10px 18px; }
  .quiz-header { flex-direction: column; text-align: center; }
  .flashcard-face { min-height: 250px; padding: 30px 24px; }
  .search-box { max-width: none; }
}

/* ===== ANIMATIONS ===== */
@keyframes slideUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-in { animation: slideUp 0.5s ease forwards; }

/* highlight search */
mark {
  background: rgba(227,6,19,0.2);
  color: inherit;
  padding: 1px 4px;
  border-radius: 3px;
}
.hidden { display: none !important; }

/* ===== FLASHCARD SESSION FILTER ===== */
.fc-filter-row {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  justify-content: center;
  margin-bottom: 20px;
}
.fc-filter-btn {
  padding: 6px 14px;
  border-radius: 50px;
  border: 2px solid var(--border);
  background: var(--bg-card);
  color: var(--text-secondary);
  font-size: 0.8em;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
}
.fc-filter-btn:hover { border-color: var(--primary); color: var(--primary); }
.fc-filter-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

/* ===== QUIZ MODE SELECTOR ===== */
.quiz-mode-selector {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}
.quiz-mode-card {
  background: var(--bg-card);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  padding: 24px 20px;
  text-align: center;
  cursor: pointer;
  transition: var(--transition);
}
.quiz-mode-card:hover { border-color: var(--primary); transform: translateY(-3px); box-shadow: var(--shadow-hover); }
.quiz-mode-card.active { border-color: var(--primary); background: rgba(227,6,19,0.05); }
.quiz-mode-card h4 { font-size: 1em; margin-bottom: 6px; color: var(--text); }
.quiz-mode-card p { font-size: 0.8em; color: var(--text-secondary); line-height: 1.4; }
.quiz-mode-icon { font-size: 2em; margin-bottom: 8px; }

/* ===== QUIZ TIMER ===== */
.quiz-timer {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: var(--error-bg);
  color: var(--error);
  padding: 8px 18px;
  border-radius: 50px;
  font-weight: 700;
  font-size: 1.1em;
  border: 2px solid var(--error);
}
.quiz-timer.warning { animation: timerPulse 1s ease-in-out infinite; }
@keyframes timerPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
.quiz-timer.hidden-timer { display: none; }

/* ===== QUIZ SESSION FILTER ===== */
.quiz-session-filter {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  justify-content: center;
  margin-bottom: 16px;
}
</style>
</head>
<body>

<!-- HERO -->
<div class="hero">
  <h1>Consumer & Market Studies</h1>
  <p class="subtitle">CA1 - Interactive Revision Guide</p>
  <div class="exam-badge">
    <span>15 MCQ Questions</span>
    <div class="badge-dot"></div>
    <span>15 Minutes</span>
    <div class="badge-dot"></div>
    <span>Sessions 1-9</span>
    <div class="badge-dot"></div>
    <span>No Negative Points</span>
  </div>
</div>

<!-- CONTROLS BAR -->
<div class="controls-bar">
  <div class="controls-left">
    <div class="search-box">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/></svg>
      <input type="text" id="searchInput" placeholder="Search concepts, terms, definitions..." oninput="handleSearch(this.value)">
    </div>
    <div class="progress-container">
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
      <span id="progressText">0%</span>
    </div>
  </div>
  <div class="controls-right">
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode"></button>
  </div>
</div>

<!-- MODE SWITCHER -->
<div class="mode-switcher">
  <button class="mode-btn active" onclick="switchMode('study')" data-mode="study">
    <svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/></svg>
    Study
  </button>
  <button class="mode-btn" onclick="switchMode('flashcards')" data-mode="flashcards">
    <svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"/></svg>
    Flashcards
  </button>
  <button class="mode-btn" onclick="switchMode('quiz')" data-mode="quiz">
    <svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"/></svg>
    Quiz
  </button>
  <button class="mode-btn" onclick="switchMode('cheatsheet')" data-mode="cheatsheet">
    <svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"/></svg>
    Cheat Sheet
  </button>
  <button class="mode-btn" onclick="switchMode('examtips')" data-mode="examtips">
    <svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"/></svg>
    Exam Tips
  </button>
</div>

<!-- NAV TABS (Session filter) -->
<div class="nav-tabs" id="navTabs">
  <button class="nav-tab active" onclick="filterSession('all')">All Sessions</button>
  <button class="nav-tab" onclick="filterSession(1)">S1 - Intro</button>
  <button class="nav-tab" onclick="filterSession(2)">S2 - Attitude</button>
  <button class="nav-tab" onclick="filterSession(3)">S3 - Perception</button>
  <button class="nav-tab" onclick="filterSession(4)">S4 - Early Phases</button>
  <button class="nav-tab" onclick="filterSession(5)">S5 - Secondary Data</button>
  <button class="nav-tab" onclick="filterSession(6)">S6 - Qualitative</button>
  <button class="nav-tab" onclick="filterSession(8)">S8 - Qual Analysis</button>
  <button class="nav-tab" onclick="filterSession(9)">S9 - Quantitative</button>
</div>

<div class="container">

<!-- ==================== STUDY MODE ==================== -->
<div class="section active" id="studySection">

<!-- SESSION 1 -->
<div class="session-card open" data-session="1">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">1</div>
      <div class="session-info">
        <h3>Introducing Consumer and Market Studies</h3>
        <p>Consumer behaviour, market study definition, role of market study</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="concept">
        <div class="concept-title">Consumer Behaviour</div>
        <p>The processes involved when individuals or groups <strong>select, purchase, use, or dispose of</strong> products, services, ideas, or experiences to <strong>satisfy needs and desires</strong>.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Market Study</div>
        <p>The <strong>systematic and objective</strong> identification, collection, analysis, dissemination, and use of information for the purpose of <strong>improving decision making</strong> related to the identification and solution of problems and opportunities in marketing.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Role of Market Study</div>
        <p>Market studies help organizations understand their consumers and markets to make <strong>better-informed marketing decisions</strong>. They reduce uncertainty by providing factual data instead of assumptions.</p>
      </div>
    </div>
  </div>
</div>

<!-- SESSION 2 -->
<div class="session-card" data-session="2">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">2</div>
      <div class="session-info">
        <h3>Attitude, Behaviour and Belief</h3>
        <p>Consumer behaviour model, attitude vs behaviour vs belief</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="concept">
        <div class="concept-title">Model of Consumer Behaviour</div>
        <p><strong>Environment</strong> (marketing stimuli + other stimuli) <span class="process-arrow">&rarr;</span> <strong>Consumer's Black Box</strong> (characteristics + decision process) <span class="process-arrow">&rarr;</span> <strong>Consumer Responses</strong> (attitudes, purchase behaviour, etc.)</p>
      </div>
      <div class="concept">
        <div class="concept-title">Behaviour</div>
        <p>What a consumer <strong>does</strong>. It is <strong>observed and factual</strong> - you can see it.<br>Example: "I buy organic food every week."</p>
      </div>
      <div class="concept">
        <div class="concept-title">Attitude</div>
        <p>What a consumer <strong>thinks or feels</strong>. It <strong>cannot be directly observed</strong>. It is an overall evaluation (positive or negative) of an object, person, or issue.<br>Example: "I think organic food is healthier."</p>
      </div>
      <div class="concept">
        <div class="concept-title">Belief</div>
        <p>The <strong>cognitive information</strong> a consumer holds about an attitude object. It is what the consumer <strong>knows or thinks they know</strong>.<br>Example: "Organic food contains no pesticides."</p>
      </div>
      <div class="tip">Behaviour = ACTION (observable) | Attitude = EVALUATION (feeling/thinking) | Belief = KNOWLEDGE (cognitive info)</div>
      <div class="concept">
        <div class="concept-title">ABC Model: 3 Components of Attitude</div>
        <p><strong>A = Affect:</strong> what you <strong>feel</strong> about the object (emotions, feelings).<br>
        <strong>B = Behaviour (Conation):</strong> your <strong>intention to act</strong> toward the object.<br>
        <strong>C = Cognition:</strong> what you <strong>know or believe</strong> about the object (knowledge, beliefs).</p>
      </div>
      <div class="concept">
        <div class="concept-title">How Attitudes Form</div>
        <p><strong>1. Direct Experience:</strong> personal interaction with the product or service. Produces <strong>stronger, more confidently held attitudes</strong>.<br>
        <strong>2. Classical Conditioning:</strong> pairing a <strong>neutral stimulus</strong> with one that <strong>naturally elicits a response</strong> (e.g., pleasant music + brand).<br>
        <strong>3. Operant (Instrumental) Conditioning:</strong> attitudes shaped by <strong>rewards and punishments</strong> following a behaviour.</p>
      </div>
      <div class="concept">
        <div class="concept-title">3 Types of Consumer Characteristics</div>
        <p><strong>Personal:</strong> age, lifestyle, personality, self-concept.<br>
        <strong>Psychological:</strong> motivation, perception, learning, attitudes, beliefs.<br>
        <strong>Socio-cultural:</strong> culture, social class, family, reference groups.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Properties of Beliefs</div>
        <p>Beliefs are <strong>resistant to change</strong>. They can be <strong>positive, neutral, or negative</strong>. They represent cognitive information and inform attitudes. A belief is NOT the same as an attitude (belief = knowledge claim; attitude = overall evaluation).</p>
      </div>
    </div>
  </div>
</div>

<!-- SESSION 3 -->
<div class="session-card" data-session="3">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">3</div>
      <div class="session-info">
        <h3>Perception, Motivation and Emotion</h3>
        <p>Perceptual process, functional vs symbolic attributes, motivation, emotion</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="concept">
        <div class="concept-title">Perception</div>
        <p>The process by which sensory information is <strong>selected, organized, and interpreted</strong>. It is how people make sense of the world around them.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Sensation</div>
        <p>The <strong>immediate response</strong> of sensory receptors (eyes, ears, nose, mouth, skin) to basic stimuli such as light, colour, sound, odour, and texture.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Perceptual Process (Solomon, 2018)</div>
        <div class="process-flow">
          <span class="process-step">Sensory stimuli</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Sensory receptors</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Exposure</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Attention</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Interpretation</span>
        </div>
      </div>
      <div class="concept">
        <div class="concept-title">Functional vs. Symbolic Attributes</div>
        <p><strong>Functional attributes:</strong> tangible, measurable characteristics (taste, smell, price, weight).<br>
        <strong>Symbolic attributes:</strong> intangible characteristics (brand image, quality perception, authenticity, status).</p>
      </div>
      <div class="concept">
        <div class="concept-title">Motivation</div>
        <p>The <strong>process that leads people to behave as they do</strong>. It occurs when a <strong>need is aroused</strong> that the consumer wishes to satisfy. The need creates a state of tension that drives the consumer to reduce it.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Absolute Threshold vs. Differential Threshold (JND)</div>
        <p><strong>Absolute threshold:</strong> the <strong>minimum amount of stimulation</strong> that can be detected on a sensory channel.<br>
        <strong>Differential threshold (JND - Just Noticeable Difference):</strong> the ability to detect <strong>changes or differences</strong> between two stimuli.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Subliminal Perception</div>
        <p>Stimuli that fall <strong>below the absolute threshold</strong>. The consumer is <strong>not consciously aware</strong> of the stimulus, but behaviour may still be influenced.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Perceptual Vigilance vs. Perceptual Defence</div>
        <p><strong>Perceptual vigilance:</strong> consumers are more likely to <strong>notice stimuli related to their current needs</strong>.<br>
        <strong>Perceptual defence:</strong> consumers <strong>block or filter out</strong> threatening or unpleasant stimuli (people see what they want to see).</p>
      </div>
      <div class="concept">
        <div class="concept-title">Sensory Overload</div>
        <p>Occurs when consumers are exposed to <strong>far more information than they can process</strong>. Common in multitasking and digital environments.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Maslow's Hierarchy of Needs (5 levels)</div>
        <div class="process-flow">
          <span class="process-step">1. Physiological</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">2. Safety</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">3. Belongingness/Love</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">4. Esteem</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">5. Self-Actualization</span>
        </div>
        <p style="margin-top:8px"><em>Limitation: culture-specific, the strict order may not apply universally.</em></p>
      </div>
      <div class="concept">
        <div class="concept-title">Murray's Psychogenic Needs (6 categories)</div>
        <p><strong>Ambition, Materialism, Power, Affection, Information, Snobbery.</strong><br>
        Differs from Maslow by identifying specific psychological needs rather than a strict hierarchy.</p>
      </div>
      <div class="concept">
        <div class="concept-title">3 Motivational Conflicts</div>
        <p><strong>Approach-Approach:</strong> choice between <strong>two desirable options</strong> (e.g., two great holiday destinations).<br>
        <strong>Approach-Avoidance:</strong> product has <strong>both positive and negative</strong> qualities (e.g., want cake but worried about calories).<br>
        <strong>Avoidance-Avoidance:</strong> choice between <strong>two undesirable options</strong> (e.g., spend money on car repair or take the bus).</p>
      </div>
      <div class="concept">
        <div class="concept-title">Affect, Moods vs. Emotions</div>
        <p><strong>Affect:</strong> umbrella term for moods + emotions.<br>
        <strong>Moods:</strong> mild, diffuse, <strong>no clear cause</strong>, last <strong>longer</strong>.<br>
        <strong>Emotions:</strong> intense, specific, <strong>clearly identified cause</strong>, <strong>short-lived</strong>.</p>
      </div>
    </div>
  </div>
</div>

<!-- SESSION 4 -->
<div class="session-card" data-session="4">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">4</div>
      <div class="session-info">
        <h3>Early Phases of a Market Study</h3>
        <p>5-stage process, MDP vs MSP, brief vs proposal, study design types</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="concept">
        <div class="concept-title">Market Study Process (5 Stages)</div>
        <div class="process-flow">
          <span class="process-step">1. Formulate the problem</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">2. Determine study design</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">3. Data collection & sampling</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">4. Analyze & interpret</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">5. Report & delivery</span>
        </div>
        <p style="margin-top:10px;font-style:italic;">All of this leads to &rarr; <strong>Make decisions</strong></p>
      </div>
      <div class="concept">
        <div class="concept-title">MDP vs. MSP</div>
        <p><strong>Management Decision Problem (MDP):</strong> asks what the <strong>decision maker needs to do</strong>. Action-oriented.<br>Example: "Should Starbucks launch a drive-thru in France?"</p>
        <p style="margin-top:8px"><strong>Marketing Study Problem (MSP):</strong> asks what <strong>information is needed</strong> and how it can be best obtained. Research-oriented.<br>Example: "What are consumer beliefs, perceptions, motivations, barriers towards a Starbucks drive-thru?"</p>
      </div>
      <div class="concept">
        <div class="concept-title">Brief vs. Proposal</div>
        <p><strong>Brief</strong> = from the <strong>client</strong>. Contains: background, business objectives, stakeholders, scope, outcomes, budget/timing.<br>
        <strong>Proposal</strong> = from the <strong>research institute/supplier</strong>. Contains: project title, marketing problem, purpose, methodology, sample plan, timeline, budget, ethical concerns.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Study Design Types</div>
        <p><strong>Exploratory studies:</strong> provide <strong>insights and understanding</strong>. Flexible, unstructured.<br>
        <strong>Conclusive studies:</strong> test <strong>specific hypotheses</strong> and examine relationships. Structured, quantitative.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Descriptive Study (Conclusive)</div>
        <p>Describes <strong>market characteristics</strong>: user profiles, percentages of behaviours, determines triggers. It is <strong>explanatory</strong>.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Causal Study (Conclusive)</div>
        <p>Provides evidence of <strong>cause-and-effect relationships</strong>. Does X (cause) influence Y (effect)? It is <strong>confirmatory</strong>.</p>
      </div>
      <div class="table-wrap">
        <table>
          <tr><th>Study Design</th><th>Type</th><th>Purpose</th><th>Method</th></tr>
          <tr><td><strong>Exploratory</strong></td><td>Qualitative</td><td>Understand, explore, gain insights</td><td>Secondary data, interviews, focus groups</td></tr>
          <tr><td><strong>Descriptive</strong></td><td>Conclusive / Quantitative</td><td>Describe, measure, explain</td><td>Survey, questionnaire</td></tr>
          <tr><td><strong>Causal</strong></td><td>Conclusive / Quantitative</td><td>Confirm cause-effect relationships</td><td>Experiments, survey</td></tr>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- SESSION 5 -->
<div class="session-card" data-session="5">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">5</div>
      <div class="session-info">
        <h3>Secondary Data Analysis</h3>
        <p>Primary vs secondary data, internal vs external, uses and evaluation</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="concept">
        <div class="concept-title">Primary vs. Secondary Data</div>
        <p><strong>Primary data:</strong> originated by the researcher <strong>for the specific purpose</strong> of addressing the study problem at hand.<br>
        <strong>Secondary data:</strong> data collected <strong>for some other purpose</strong> than the problem at hand. They are <strong>existing data</strong>.</p>
      </div>
      <div class="table-wrap">
        <table>
          <tr><th></th><th>Primary Data</th><th>Secondary Data</th></tr>
          <tr><td><strong>Collection purpose</strong></td><td>For the problem at hand</td><td>For other problems</td></tr>
          <tr><td><strong>Collection process</strong></td><td>Very involved</td><td>Rapid and easy</td></tr>
          <tr><td><strong>Collection cost</strong></td><td>High</td><td>Relatively low</td></tr>
          <tr><td><strong>Collection time</strong></td><td>Long</td><td>Short</td></tr>
        </table>
      </div>
      <div class="concept">
        <div class="concept-title">Prerequisite</div>
        <p>Examination of secondary data is a <strong>prerequisite</strong> to the collection of primary data. A market study always starts with secondary data.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Internal vs. External Secondary Data</div>
        <p><strong>Internal data:</strong> available <strong>within</strong> the organization (client database, CRM/ERP, internal reports, previous studies).<br>
        <strong>External data:</strong> <strong>outside</strong> the organization (government sources/census, professional associations, professional press, social media, syndicated services).</p>
      </div>
      <div class="concept">
        <div class="concept-title">Uses of Secondary Data</div>
        <p>Identify the problem, better define the problem, develop an approach, formulate research design, answer study questions, interpret primary data more insightfully.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Three Sieves of Socrates</div>
        <p>When evaluating secondary data: 1) Is it <strong>true</strong>? 2) Is it <strong>good</strong>? 3) Is it <strong>useful</strong>?<br>
        Also evaluate: methodology, accuracy, currency, content, purpose, and credibility.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Exploratory Research Method (5 steps)</div>
        <div class="process-flow">
          <span class="process-step">Identify object & field</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Use keywords</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Identify nature & content</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Consult resources</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">Write up properly</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SESSION 6 -->
<div class="session-card" data-session="6">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">6</div>
      <div class="session-info">
        <h3>Qualitative Study: Aims, Interviews and Interview Guide</h3>
        <p>Qualitative methods, depth interviews, sampling, saturation effect</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="concept">
        <div class="concept-title">Qualitative Study</div>
        <p>An <strong>unstructured, exploratory</strong> research methodology based on <strong>small samples</strong> intended to provide <strong>insight and understanding</strong> of a social phenomenon within its natural setting. It focuses on <strong>words, concepts, ideas, opinions</strong>. Data is <strong>non-numerical</strong>.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Qualitative Study Procedures</div>
        <p><strong>Direct (nondisguised):</strong> Focus Groups, Depth Interviews<br>
        <strong>Indirect (disguised):</strong> Projective Techniques</p>
      </div>
      <div class="concept">
        <div class="concept-title">Advantages & Disadvantages</div>
        <p><strong>Advantages:</strong> deeper insights than secondary data, uncover underlying reasons, probe for motivations, free exchange of information, attribute responses to respondents.<br>
        <strong>Disadvantages:</strong> skilled interviewers are expensive, small sample (not conclusive), quality depends on interviewer.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Depth Interview</div>
        <p>A <strong>direct, personal interview</strong> where a single respondent is probed by a skilled interviewer to uncover underlying opinions, motivations, beliefs, attitudes, and feelings. Can be structured or unstructured.</p>
        <p style="margin-top:6px"><strong>Characteristics:</strong> one-to-one, single topic, 30 min to 1 hour, diversity of participants, recording recommended.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Sample Selection Criteria (Initial Target)</div>
        <p>Based on: <strong>demographic</strong> (age, income, gender), <strong>psychographic</strong> (attitudes, values, lifestyle), <strong>geographic</strong> (location, availability), <strong>usage</strong> (non-user, occasional, frequent) characteristics.<br>
        Participants can be: industry experts, product users, or anyone concerned by the topic.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Qualitative Sampling Methods</div>
        <p><strong>Convenience sampling:</strong> pure chance, take-them-where-you-find-them.<br>
        <strong>Purposive sampling:</strong> identify key characteristics, find where these people are, invite them.<br>
        <strong>Snowball sampling:</strong> first participant refers others who match the profile.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Saturation Effect</div>
        <p>When you stop finding <strong>new insights, ideas, opinions, or patterns</strong> as you interview more participants. This signals the <strong>end of the interviews</strong>. It is impossible to know the exact sample size beforehand.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Interview Techniques</div>
        <p><strong>Structured interview:</strong> standardized questions, fixed order.<br>
        <strong>Semi-structured interview:</strong> set topics/questions but <strong>no imposed sequence</strong>, free to ask follow-up questions.<br>
        <strong>Narrative interview:</strong> open-ended, respondent tells their story.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Interview Guide: 4 Phases</div>
        <div class="process-flow">
          <span class="process-step">1. Introductory</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">2. Subject Centering</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">3. Deepening</span>
          <span class="process-arrow">&rarr;</span>
          <span class="process-step">4. Closing</span>
        </div>
        <p style="margin-top:8px">It is a flexible canvas giving precise signs for each phase. All questions should be <strong>open-ended</strong> (not yes/no).</p>
      </div>
      <div class="concept">
        <div class="concept-title">3 Question Types in Interview Guide</div>
        <p><strong>Descriptive questions:</strong> ask for <strong>facts</strong> (what, how).<br>
        <strong>Casual questions:</strong> ask for <strong>reasons</strong> (why a behaviour/opinion exists).<br>
        <strong>Consequence questions:</strong> ask <strong>what happens</strong> as a result of a behaviour.</p>
      </div>
      <div class="table-wrap">
        <table>
          <tr><th>Interviewer Should DO</th><th>Interviewer Should NOT DO</th></tr>
          <tr><td>Listen actively</td><td>Fear silence</td></tr>
          <tr><td>Stay objective</td><td>Interrupt the interviewee</td></tr>
          <tr><td>Show understanding (without interpretation)</td><td>Be directive or impose structure</td></tr>
          <tr><td>Strengthen a point discussed previously</td><td>Induce responses</td></tr>
          <tr><td>Make summaries using interviewee's words</td><td>Interpret or give opinions/judgments</td></tr>
          <tr><td>Record the interview and take notes</td><td></td></tr>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- SESSION 8 -->
<div class="session-card" data-session="8">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">8</div>
      <div class="session-info">
        <h3>Qualitative Data Analysis</h3>
        <p>Thematic analysis, 7 steps, codes, themes, excerpts, hierarchy</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="concept">
        <div class="concept-title">Analysis (Bernard, 2006)</div>
        <p>The search for <strong>patterns in data</strong> and for ideas that help explain why those patterns are there.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Thematic Analysis</div>
        <p>A data analysis process that involves delving through a data set, <strong>identifying patterns</strong>, systematically <strong>coding</strong>, deriving <strong>themes</strong>, and creating a <strong>narrative</strong>.</p>
      </div>
      <div class="concept">
        <div class="concept-title">7 Steps of Qualitative Analysis</div>
        <p><strong>Step 1: Familiarize yourself with data</strong> - Transcribe interviews, read transcripts, identify meanings and patterns.</p>
        <p><strong>Step 2: Come up with initial codes</strong> - A code is a word/phrase that captures the essence of an excerpt.</p>
        <p><strong>Step 3: Decide what you code</strong> - Identify relevant excerpts, apply appropriate codes. Same meaning = same code.</p>
        <p><strong>Step 4: Merge codes with supporting excerpts</strong> - Group excerpts by code (= codifying). This allows deeper understanding.</p>
        <p><strong>Step 5: Group codes into themes</strong> - A theme is nuanced, complex, meaningful and related to the information needed.</p>
        <p><strong>Step 6: Assess and revise themes</strong> - Check relevance, ensure enough data per theme, themes must be mutually exclusive. Merge similar themes, delete non-contributing ones. Iterative process.</p>
        <p><strong>Step 7: Write the results</strong> - Tell a consistent story, use quotes to support ideas, provide interpretive analysis.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Key Vocabulary</div>
        <p><span class="key-term">Excerpt</span> = word-for-word reproduction of verbal data (verbatim).<br>
        <span class="key-term">Code</span> = word/phrase capturing the essence of an excerpt.<br>
        <span class="key-term">Codifying</span> = grouping and categorizing data by codes.<br>
        <span class="key-term">Theme</span> = grouping of codes that says something meaningful about the MSP.<br>
        <span class="key-term">Sub-theme</span> = codes grouped under a theme (e.g., Frustration + Anger = Negative Emotions).</p>
      </div>
      <div class="concept">
        <div class="concept-title">Hierarchy of Themes</div>
        <p><strong>Strong themes</strong> = most recurring (high frequency of excerpts, many respondents).<br>
        <strong>Weak themes</strong> = less recurring.<br>
        Depends on: frequency of excerpts, number of interviews addressing the code, and length of verbatim.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Important: Limitations</div>
        <p>Findings of a qualitative study <strong>can't be generalized</strong> (sample too small, not statistically representative) but they provide insights and help in <strong>questionnaire design</strong> for the quantitative phase.</p>
      </div>
    </div>
  </div>
</div>

<!-- SESSION 9 -->
<div class="session-card" data-session="9">
  <div class="session-header" onclick="toggleSession(this)">
    <div style="display:flex;align-items:center;gap:16px;flex:1;min-width:0">
      <div class="session-number">9</div>
      <div class="session-info">
        <h3>Quantitative Study: Aims, Sampling and Data Collection</h3>
        <p>Qualitative vs quantitative, sampling methods, probability vs non-probability</p>
      </div>
    </div>
    <div class="session-toggle">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"/></svg>
    </div>
  </div>
  <div class="session-body">
    <div class="session-content">
      <div class="table-wrap">
        <table>
          <tr><th></th><th>Qualitative Study</th><th>Quantitative Study</th></tr>
          <tr><td><strong>Objective</strong></td><td>Gain qualitative understanding of underlying reasons/motivations</td><td>Quantify data and generalize results from sample to population</td></tr>
          <tr><td><strong>Sample</strong></td><td>Small, nonrepresentative</td><td>Large, statistically representative</td></tr>
          <tr><td><strong>Data collection</strong></td><td>Unstructured</td><td>Structured</td></tr>
          <tr><td><strong>Data analysis</strong></td><td>Nonstatistical</td><td>Statistical</td></tr>
          <tr><td><strong>Outcome</strong></td><td>Develop initial understanding</td><td>Recommend final course of action</td></tr>
        </table>
      </div>
      <div class="concept">
        <div class="concept-title">Quantitative Study</div>
        <p>A <strong>systematic investigation</strong> by gathering <strong>quantifiable data</strong> and performing statistical, mathematical, or computational techniques. It is <strong>explanatory (descriptive)</strong> and <strong>confirmatory (causal)</strong>: it explains and confirms relationships between variables.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Quantitative Data</div>
        <p>Information that can be <strong>counted or measured</strong> and given a numerical value. Can be <strong>intrinsically quantitative</strong> (e.g., monthly budget, annual income) or have an <strong>imposed numeric structure</strong> (e.g., Likert scale 1-5).</p>
      </div>
      <div class="concept">
        <div class="concept-title">Sampling Design Process (3 steps)</div>
        <p><strong>1. Define the population</strong> (and deduce the target to be studied).<br>
        <strong>2. Choose the sampling method</strong> (how to select participants).<br>
        <strong>3. Determine the sample size.</strong></p>
      </div>
      <div class="concept">
        <div class="concept-title">Population vs. Sample</div>
        <p><strong>Population:</strong> the defined group of individuals from which a sample is drawn.<br>
        <strong>Sample:</strong> members of a population selected to participate in a study.<br>
        Proper sampling allows us to <strong>estimate characteristics of the population as a whole</strong>.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Sampling Technique</div>
        <p>Depends on whether a <strong>sampling frame</strong> (list of target population) is <strong>available and accessible</strong>:<br>
        <strong>YES</strong> &rarr; Probability sampling<br>
        <strong>NO</strong> &rarr; Non-probability sampling</p>
      </div>
      <div class="concept">
        <div class="concept-title">Probability Sampling Methods</div>
        <p>Each member has a <strong>specifiable probability</strong> of being chosen.<br>
        <strong>Simple random sampling:</strong> every member has an equal probability.<br>
        <strong>Stratified random sampling:</strong> population divided into subgroups (strata), random samples from each.<br>
        <strong>Cluster sampling:</strong> groups/geographic areas identified as clusters, samples taken from clusters.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Non-Probability Sampling Methods</div>
        <p>Probability of any member being chosen is <strong>unknown</strong>.<br>
        <strong>Convenience sampling:</strong> haphazard, take-them-where-you-find-them.<br>
        <strong>Purposive sampling:</strong> selected based on researcher's judgment.<br>
        <strong>Snowball sampling:</strong> participants recruit others.<br>
        <strong>Quota sampling:</strong> sample reflects the numerical composition of subgroups in the population.</p>
      </div>
      <div class="concept">
        <div class="concept-title">Quota Sampling (Detail)</div>
        <p>Most used non-probability method in marketing. Reduced model of the population.<br>
        <strong>Single quota:</strong> based on <strong>1 criterion</strong> (e.g., gender only).<br>
        <strong>Cross quota:</strong> based on <strong>2+ criteria crossed</strong> (e.g., gender &times; age).<br>
        <em>Warning: too many criteria (&gt;2-3) makes it very difficult to find required respondents.</em></p>
      </div>
      <div class="concept">
        <div class="concept-title">Sample Size Formula</div>
        <p><strong>n = t&sup2;pq / e&sup2;</strong><br>
        With t = 1.96 (95% confidence), p = q = 0.5:<br>
        <strong>Simplified: n = 1/e&sup2;</strong><br>
        Example: e = 4% &rarr; n = 600 | e = 2% &rarr; n = 2,401</p>
      </div>
      <div class="table-wrap">
        <table>
          <tr><th>Confidence Level</th><th>e = 8%</th><th>e = 6%</th><th>e = 4%</th><th>e = 2%</th></tr>
          <tr><td><strong>90% (t=1.645)</strong></td><td>106</td><td>187</td><td>425</td><td>1,701</td></tr>
          <tr><td><strong>95% (t=1.960)</strong></td><td>150</td><td>267</td><td>600</td><td>2,401</td></tr>
          <tr><td><strong>99% (t=2.576)</strong></td><td>285</td><td>461</td><td>1,138</td><td>3,220</td></tr>
        </table>
      </div>
      <div class="tip">Key rule: to HALVE the margin of error, you must QUADRUPLE the sample size (e/2 &rarr; n &times; 4). Heavy consequences on time and cost.</div>
      <div class="table-wrap">
        <table>
          <tr><th>Probability Methods</th><th>Advantages</th><th>Disadvantages</th></tr>
          <tr><td><strong>Simple random</strong></td><td>Representative of population</td><td>May cost more; need full list</td></tr>
          <tr><td><strong>Stratified random</strong></td><td>Representative of population</td><td>May cost more; need full list</td></tr>
          <tr><td><strong>Cluster</strong></td><td>No need to sample from individual lists</td><td>Full list of cluster members still needed</td></tr>
        </table>
      </div>
      <div class="table-wrap">
        <table>
          <tr><th>Non-probability Methods</th><th>Advantages</th><th>Disadvantages</th></tr>
          <tr><td><strong>Convenience</strong></td><td>Inexpensive, efficient, convenient</td><td>Likely bias; not generalizable</td></tr>
          <tr><td><strong>Purposive</strong></td><td>Includes only types of interest</td><td>Likely bias; not generalizable</td></tr>
          <tr><td><strong>Snowball</strong></td><td>Same as purposive</td><td>Same as purposive</td></tr>
          <tr><td><strong>Quota</strong></td><td>Inexpensive; reduces lack of representativeness</td><td>Possible bias; no method for choosing within subgroups</td></tr>
        </table>
      </div>
    </div>
  </div>
</div>

</div><!-- end study section -->

<!-- ==================== FLASHCARD MODE ==================== -->
<div class="section" id="flashcardsSection">
  <div class="fc-filter-row" id="fcFilterRow">
    <button class="fc-filter-btn active" onclick="filterFlashcards('all')">All</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(1)">S1</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(2)">S2</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(3)">S3</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(4)">S4</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(5)">S5</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(6)">S6</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(8)">S8</button>
    <button class="fc-filter-btn" onclick="filterFlashcards(9)">S9</button>
    <button class="fc-filter-btn mastered-filter" onclick="filterFlashcards('notmastered')">Not Mastered</button>
  </div>
  <div class="flashcard-container">
    <div class="flashcard" id="flashcard" onclick="flipCard()">
      <div class="fc-session-badge" id="fcBadge">S1</div>
      <div class="flashcard-face flashcard-front">
        <h3 id="fcQuestion"></h3>
        <p>Click to reveal the answer</p>
      </div>
      <div class="flashcard-face flashcard-back">
        <p id="fcAnswer"></p>
      </div>
    </div>
    <div class="fc-mastery-row">
      <button class="fc-mastery-btn review" onclick="markCard('review')">Review Again</button>
      <button class="fc-mastery-btn got-it" onclick="markCard('gotit')">Got it!</button>
    </div>
    <div class="flashcard-controls">
      <button class="fc-btn" onclick="prevCard()">
        <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5"/></svg>
        Previous
      </button>
      <button class="fc-btn" onclick="shuffleCards()">Shuffle</button>
      <button class="fc-btn primary-btn" onclick="nextCard()">
        Next
        <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5"/></svg>
      </button>
    </div>
    <div class="flashcard-progress" id="fcProgress"></div>
    <div class="fc-mastery-counter" id="fcMastery">Mastered: 0 / 72</div>
  </div>
</div>

<!-- ==================== QUIZ MODE ==================== -->
<div class="section" id="quizSection">
  <div class="quiz-mode-selector" id="quizModeSelector">
    <div class="quiz-mode-card" onclick="startQuizMode('quick10')">
      <div class="quiz-mode-icon">&#9889;</div>
      <h4>Quick 10</h4>
      <p>10 random questions. Fast practice.</p>
    </div>
    <div class="quiz-mode-card" onclick="startQuizMode('exam')">
      <div class="quiz-mode-icon">&#127891;</div>
      <h4>Exam Simulation</h4>
      <p>15 questions, 15 minutes timer. Like the real CA1.</p>
    </div>
    <div class="quiz-mode-card" onclick="startQuizMode('session')">
      <div class="quiz-mode-icon">&#128218;</div>
      <h4>By Session</h4>
      <p>Pick a session and practice its questions.</p>
    </div>
    <div class="quiz-mode-card" onclick="startQuizMode('full')">
      <div class="quiz-mode-icon">&#128170;</div>
      <h4>Full Practice</h4>
      <p>All questions. Complete review.</p>
    </div>
  </div>
  <div class="quiz-session-filter hidden" id="quizSessionFilter">
    <button class="fc-filter-btn" onclick="startSessionQuiz(1)">S1</button>
    <button class="fc-filter-btn" onclick="startSessionQuiz(2)">S2</button>
    <button class="fc-filter-btn" onclick="startSessionQuiz(3)">S3</button>
    <button class="fc-filter-btn" onclick="startSessionQuiz(4)">S4</button>
    <button class="fc-filter-btn" onclick="startSessionQuiz(5)">S5</button>
    <button class="fc-filter-btn" onclick="startSessionQuiz(6)">S6</button>
    <button class="fc-filter-btn" onclick="startSessionQuiz(8)">S8</button>
    <button class="fc-filter-btn" onclick="startSessionQuiz(9)">S9</button>
  </div>
  <div class="quiz-header hidden" id="quizHeader">
    <div class="quiz-score">
      <div class="score-circle" id="scoreCircle">
        <span class="score-text" id="scoreText">0%</span>
      </div>
      <div class="quiz-info">
        <h3 id="quizTitle">Practice Quiz</h3>
        <p id="quizProgress">0 / 0 answered</p>
      </div>
    </div>
    <div style="display:flex;align-items:center;gap:12px">
      <div class="quiz-timer hidden-timer" id="quizTimer">
        <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/></svg>
        <span id="timerDisplay">15:00</span>
      </div>
      <div class="quiz-actions">
        <button class="quiz-btn reset-btn" onclick="backToModeSelect()">Back</button>
        <button class="quiz-btn reset-btn" onclick="resetQuiz()">Reset</button>
      </div>
    </div>
  </div>
  <div id="quizContainer"></div>
  <div class="quiz-results" id="quizResults">
    <div class="results-circle" id="resultsCircle"></div>
    <div class="results-msg" id="resultsMsg"></div>
    <div class="results-sub" id="resultsSub"></div>
    <button class="fc-btn primary-btn" onclick="backToModeSelect()" style="margin:0 auto">Back to Modes</button>
  </div>
</div>

<!-- ==================== CHEAT SHEET MODE ==================== -->
<div class="section" id="cheatsheetSection">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:10px">
    <div class="fc-filter-row" id="csFilterRow" style="margin:0">
      <button class="fc-filter-btn active" onclick="filterCheatSheet('all')">All</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(1)">S1</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(2)">S2</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(3)">S3</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(4)">S4</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(5)">S5</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(6)">S6</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(8)">S8</button>
      <button class="fc-filter-btn" onclick="filterCheatSheet(9)">S9</button>
    </div>
    <button class="fc-btn" onclick="window.print()" style="padding:8px 18px;font-size:0.8em">Print</button>
  </div>
  <div class="cheat-grid">
    <!-- S1 -->
    <div class="cheat-card" data-cs="1">
      <h4>Consumer Behaviour Model</h4>
      <p><strong>Environment</strong> &rarr; <strong>Black Box</strong> (characteristics + decision process) &rarr; <strong>Responses</strong></p>
    </div>
    <!-- S2 -->
    <div class="cheat-card" data-cs="2">
      <h4>Behaviour vs. Attitude vs. Belief</h4>
      <p><strong>Behaviour</strong> = what you DO (observable)<br><strong>Attitude</strong> = what you THINK/FEEL (evaluation)<br><strong>Belief</strong> = what you KNOW (cognitive info, resistant to change)</p>
    </div>
    <div class="cheat-card" data-cs="2">
      <h4>ABC Model of Attitude</h4>
      <p><strong>A</strong> = Affect (feel) | <strong>B</strong> = Behaviour/Conation (intend to act) | <strong>C</strong> = Cognition (know/believe)</p>
    </div>
    <div class="cheat-card" data-cs="2">
      <h4>3 Ways Attitudes Form</h4>
      <p><strong>1.</strong> Direct experience (strongest)<br><strong>2.</strong> Classical conditioning (pairing stimuli)<br><strong>3.</strong> Operant conditioning (rewards/punishments)</p>
    </div>
    <!-- S3 -->
    <div class="cheat-card" data-cs="3">
      <h4>Sensation vs. Perception</h4>
      <p><strong>Sensation</strong> = immediate response of senses<br><strong>Perception</strong> = selecting + organizing + interpreting sensory info</p>
    </div>
    <div class="cheat-card" data-cs="3">
      <h4>Perceptual Process</h4>
      <p>Stimuli &rarr; Receptors &rarr; Exposure &rarr; Attention &rarr; Interpretation</p>
    </div>
    <div class="cheat-card" data-cs="3">
      <h4>Absolute vs. Differential Threshold</h4>
      <p><strong>Absolute</strong> = minimum stimulation detected<br><strong>Differential (JND)</strong> = detect changes/differences between stimuli</p>
    </div>
    <div class="cheat-card" data-cs="3">
      <h4>Maslow's 5 Levels</h4>
      <p>1. Physiological &rarr; 2. Safety &rarr; 3. Belongingness &rarr; 4. Esteem &rarr; 5. Self-Actualization</p>
    </div>
    <div class="cheat-card" data-cs="3">
      <h4>3 Motivational Conflicts</h4>
      <p><strong>Approach-Approach</strong> = 2 desirable<br><strong>Approach-Avoidance</strong> = + and - qualities<br><strong>Avoidance-Avoidance</strong> = 2 undesirable</p>
    </div>
    <div class="cheat-card" data-cs="3">
      <h4>Moods vs. Emotions</h4>
      <p><strong>Moods</strong> = mild, diffuse, no clear cause, longer<br><strong>Emotions</strong> = intense, specific, clear cause, short-lived</p>
    </div>
    <!-- S4 -->
    <div class="cheat-card" data-cs="4">
      <h4>Market Study Process (5 Stages)</h4>
      <p>1. Formulate problem &rarr; 2. Study design &rarr; 3. Data collection &rarr; 4. Analyze &rarr; 5. Report &rarr; <strong>Decide</strong></p>
    </div>
    <div class="cheat-card" data-cs="4">
      <h4>MDP vs. MSP</h4>
      <p><strong>MDP</strong> = what to DO (action-oriented)<br><strong>MSP</strong> = what to STUDY (information-oriented)</p>
    </div>
    <div class="cheat-card" data-cs="4">
      <h4>Brief vs. Proposal</h4>
      <p><strong>Brief</strong> = from CLIENT<br><strong>Proposal</strong> = from RESEARCH INSTITUTE</p>
    </div>
    <div class="cheat-card" data-cs="4">
      <h4>Descriptive vs. Causal Study</h4>
      <p><strong>Descriptive</strong> = describe, measure, explain (explanatory)<br><strong>Causal</strong> = cause-and-effect relationships (confirmatory)</p>
    </div>
    <!-- S5 -->
    <div class="cheat-card" data-cs="5">
      <h4>Primary vs. Secondary Data</h4>
      <p><strong>Primary</strong> = collected FOR this study (expensive, long)<br><strong>Secondary</strong> = already exists (cheap, fast, prerequisite)</p>
    </div>
    <div class="cheat-card" data-cs="5">
      <h4>Internal vs. External Secondary Data</h4>
      <p><strong>Internal</strong> = within the organization (CRM, reports)<br><strong>External</strong> = outside (government, press, syndicated)</p>
    </div>
    <div class="cheat-card" data-cs="5">
      <h4>Three Sieves of Socrates</h4>
      <p>Evaluate secondary data: 1) <strong>True</strong>? 2) <strong>Good</strong>? 3) <strong>Useful</strong>?</p>
    </div>
    <!-- S6 -->
    <div class="cheat-card" data-cs="6">
      <h4>Qualitative vs. Quantitative</h4>
      <p><strong>Qualitative</strong> = small sample, non-numerical, insights<br><strong>Quantitative</strong> = large sample, numerical, statistical</p>
    </div>
    <div class="cheat-card" data-cs="6">
      <h4>Exploratory vs. Conclusive</h4>
      <p><strong>Exploratory</strong> = insights, understanding, flexible<br><strong>Conclusive</strong> = test hypotheses, structured</p>
    </div>
    <div class="cheat-card" data-cs="6">
      <h4>Interview Guide: 4 Phases</h4>
      <p>1. Introductory &rarr; 2. Subject Centering &rarr; 3. Deepening &rarr; 4. Closing</p>
    </div>
    <div class="cheat-card" data-cs="6">
      <h4>Interviewer Do's &amp; Don'ts</h4>
      <p><strong>Do:</strong> listen, stay objective, summarize<br><strong>Don't:</strong> fear silence, interrupt, induce, interpret, give opinions</p>
    </div>
    <div class="cheat-card" data-cs="6">
      <h4>Interview Types</h4>
      <p><strong>Structured</strong> = fixed order<br><strong>Semi-structured</strong> = flexible order<br><strong>Narrative</strong> = open-ended story</p>
    </div>
    <div class="cheat-card" data-cs="6">
      <h4>Saturation Effect</h4>
      <p>When <strong>no new insights</strong> emerge. Signals end of interviews. Sample size unknown beforehand.</p>
    </div>
    <!-- S8 -->
    <div class="cheat-card" data-cs="8">
      <h4>Thematic Analysis Flow</h4>
      <p>Transcript &rarr; <strong>Excerpt</strong> &rarr; <strong>Code</strong> &rarr; <strong>Sub-theme</strong> &rarr; <strong>Theme</strong> &rarr; <strong>Narrative</strong></p>
    </div>
    <div class="cheat-card" data-cs="8">
      <h4>7 Steps of Qual Analysis</h4>
      <p>1. Familiarize &rarr; 2. Initial codes &rarr; 3. Decide what to code &rarr; 4. Codifying &rarr; 5. Themes &rarr; 6. Revise &rarr; 7. Write results</p>
    </div>
    <!-- S9 -->
    <div class="cheat-card" data-cs="9">
      <h4>Probability vs. Non-probability</h4>
      <p><strong>Probability</strong> (frame available): simple random, stratified, cluster<br><strong>Non-probability</strong> (no frame): convenience, purposive, snowball, quota</p>
    </div>
    <div class="cheat-card" data-cs="9">
      <h4>Quota Sampling</h4>
      <p><strong>Single</strong> = 1 criterion (gender)<br><strong>Cross</strong> = 2+ criteria (gender x age)<br>Most used non-probability method</p>
    </div>
    <div class="cheat-card" data-cs="9">
      <h4>Sample Size Formula</h4>
      <p>n = 1/e&sup2; (at 95% confidence)<br>e=4% &rarr; n=600 | e=2% &rarr; n=2401<br><strong>e/2 &rarr; n &times; 4</strong></p>
    </div>
  </div>
</div>

<!-- ==================== EXAM TIPS MODE ==================== -->
<div class="section" id="examtipsSection">
  <div class="tips-section">
    <div class="tip-card">
      <h4>Exam Format</h4>
      <ul>
        <li><strong>15 MCQ questions</strong> - only 1 correct answer per question</li>
        <li><strong>15 minutes</strong> - about 1 minute per question</li>
        <li><strong>No negative points</strong> - always answer, never leave blank!</li>
        <li>Covers <strong>Sessions 1 to 9</strong> (Session 7 = work-in-progress, no content)</li>
        <li>Takes place at the <strong>beginning of Session 11</strong></li>
      </ul>
    </div>
    <div class="tip-card">
      <h4>Strategy</h4>
      <ul>
        <li>Read ALL 4 options before choosing</li>
        <li><strong>1 minute max per question</strong> - don't get stuck</li>
        <li>If unsure, eliminate the 2 most obviously wrong answers first</li>
        <li>No negative points = always guess if you don't know</li>
        <li>Watch out for absolute words ("always", "never", "only") - often traps</li>
        <li>Pay attention to "which is NOT" questions - they reverse the logic</li>
      </ul>
    </div>
    <div class="tip-card">
      <h4>Common Traps &amp; Confusions</h4>
      <div class="trap-item"><strong>Behaviour vs Attitude vs Belief</strong> - Behaviour = action (observable), Attitude = evaluation (feeling), Belief = knowledge (cognitive). Don't mix them up!</div>
      <div class="trap-item"><strong>MDP vs MSP</strong> - MDP = what to DO (action), MSP = what to STUDY (information). They often swap these in wrong answers.</div>
      <div class="trap-item"><strong>Primary vs Secondary data</strong> - Secondary is a PREREQUISITE, comes FIRST. Primary is collected for this specific study.</div>
      <div class="trap-item"><strong>Probability vs Non-probability</strong> - Key question: is a sampling frame AVAILABLE? Yes = probability, No = non-probability.</div>
      <div class="trap-item"><strong>Perception vs Sensation</strong> - Sensation = raw input from senses. Perception = processing that input (select + organize + interpret).</div>
      <div class="trap-item"><strong>Classical vs Operant conditioning</strong> - Classical = pairing stimuli. Operant = rewards/punishments.</div>
      <div class="trap-item"><strong>Brief vs Proposal</strong> - Brief = from CLIENT. Proposal = from RESEARCH INSTITUTE. Never the other way around.</div>
    </div>
    <div class="tip-card">
      <h4>High-Frequency Topics (most likely to appear)</h4>
      <ul>
        <li><strong>S2:</strong> ABC model (3 components), how attitudes form (3 ways), behaviour vs attitude vs belief</li>
        <li><strong>S3:</strong> Perception vs sensation, absolute vs differential threshold, Maslow, motivational conflicts, moods vs emotions</li>
        <li><strong>S4:</strong> MDP vs MSP, 5 stages, descriptive vs causal study, brief vs proposal</li>
        <li><strong>S5:</strong> Primary vs secondary data, internal vs external, uses of secondary data</li>
        <li><strong>S6:</strong> Interview guide (4 phases), saturation effect, sampling methods (convenience/purposive/snowball)</li>
        <li><strong>S8:</strong> Thematic analysis steps, excerpt vs code vs theme, codifying</li>
        <li><strong>S9:</strong> Probability vs non-probability, quota sampling, sample size formula (n=1/e&sup2;), margin of error rule</li>
      </ul>
    </div>
    <div class="tip-card">
      <h4>Last-Minute Checklist</h4>
      <ul>
        <li>Can you define: behaviour, attitude, belief?</li>
        <li>Can you name the 3 components of attitude (ABC)?</li>
        <li>Can you name the 5 stages of a market study?</li>
        <li>Do you know the difference between MDP and MSP?</li>
        <li>Can you explain probability vs non-probability sampling?</li>
        <li>Can you list the 7 steps of thematic analysis?</li>
        <li>Do you know the sample size formula and the e/2 &rarr; n&times;4 rule?</li>
        <li>Can you name the 4 phases of the interview guide?</li>
      </ul>
    </div>
  </div>
</div>

</div><!-- end container -->

<!-- BACK TO TOP -->
<button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">&#8593;</button>

<!-- FOOTER -->
<div class="footer">
  Consumer and Market Studies - Y3S6 - <span>ESSCA</span> 2025/2026 - Prof. Aude RYCHALSKI<br>
  Revision document prepared for <span>Romain RABREAU</span><br>
  <button onclick="resetAllProgress()" style="margin-top:8px;padding:6px 16px;border-radius:20px;border:1px solid rgba(255,255,255,0.3);background:transparent;color:rgba(255,255,255,0.6);font-size:0.75em;cursor:pointer">Reset all progress</button>
</div>

<script>
// ===== DATA =====
const flashcards = [
  // ===== SESSION 1: Intro (3) =====
  { s:1, q: "What is Consumer Behaviour?", a: "The processes involved when individuals or groups SELECT, PURCHASE, USE, or DISPOSE of products, services, ideas, or experiences to SATISFY NEEDS AND DESIRES." },
  { s:1, q: "What is a Market Study?", a: "The SYSTEMATIC and OBJECTIVE identification, collection, analysis, dissemination, and use of INFORMATION for IMPROVING DECISION MAKING related to marketing problems and opportunities." },
  { s:1, q: "3 Roles of a Market Study?", a: "1) ASSESSING information needs, 2) PROVIDING relevant information, 3) Helping management make INFORMED DECISIONS. It reduces uncertainty with factual data." },
  // ===== SESSION 2: Attitude, Behaviour, Belief (12) =====
  { s:2, q: "Behaviour = ?", a: "What a consumer DOES. OBSERVED and FACTUAL. You can see it.\nEx: 'I buy organic food every week.'" },
  { s:2, q: "Attitude = ?", a: "What a consumer THINKS or FEELS. CANNOT be directly observed. An overall EVALUATION (positive or negative).\nEx: 'I think organic food is healthier.'" },
  { s:2, q: "Belief = ?", a: "The COGNITIVE INFORMATION a consumer holds about an attitude object. What the consumer KNOWS or thinks they know.\nEx: 'Organic food contains no pesticides.'" },
  { s:2, q: "Quick distinction: Behaviour vs Attitude vs Belief?", a: "BEHAVIOUR = ACTION (observable)\nATTITUDE = EVALUATION (feeling/thinking, not observable)\nBELIEF = KNOWLEDGE (cognitive info, resistant to change)" },
  { s:2, q: "The Consumer's Black Box contains?", a: "2 components:\n1) CONSUMER CHARACTERISTICS (personal, psychological, socio-cultural)\n2) DECISION PROCESS\nInputs = environment stimuli | Outputs = consumer responses" },
  { s:2, q: "Consumer Behaviour Model flow?", a: "ENVIRONMENT (marketing stimuli + other stimuli) -> CONSUMER'S BLACK BOX (characteristics + decision process) -> CONSUMER RESPONSES (attitudes, purchase behaviour...)" },
  { s:2, q: "3 Components of Attitude (ABC Model)?", a: "A = AFFECT (what you feel)\nB = BEHAVIOUR/Conation (intention to act)\nC = COGNITION (what you know/believe)" },
  { s:2, q: "3 Ways Attitudes Form?", a: "1) DIRECT EXPERIENCE (personal interaction -> stronger attitudes)\n2) CLASSICAL CONDITIONING (pairing neutral + natural stimulus)\n3) OPERANT CONDITIONING (rewards/punishments shape attitudes)" },
  { s:2, q: "Classical vs Operant Conditioning?", a: "CLASSICAL: neutral stimulus paired with one that naturally triggers response (e.g., music + brand)\nOPERANT: attitude shaped by REWARDS and PUNISHMENTS" },
  { s:2, q: "3 Types of Consumer Characteristics?", a: "1) PERSONAL (age, lifestyle, personality)\n2) PSYCHOLOGICAL (motivation, perception, learning, attitude)\n3) SOCIO-CULTURAL (culture, social class, family)" },
  { s:2, q: "Key Properties of Beliefs?", a: "- RESISTANT to change\n- Can be POSITIVE, NEUTRAL, or NEGATIVE\n- Represent cognitive knowledge\n- Inform attitudes" },
  { s:2, q: "How to distinguish Attitude from Belief in an MCQ?", a: "ATTITUDE = overall evaluation (like/dislike, good/bad)\nBELIEF = factual claim (true/false knowledge)\nEx: 'Organic is healthier' = ATTITUDE | 'Organic has no pesticides' = BELIEF" },
  // ===== SESSION 3: Perception, Motivation, Emotion (15) =====
  { s:3, q: "Perception = ?", a: "The process by which sensory information is SELECTED, ORGANIZED, and INTERPRETED. How people make sense of the world." },
  { s:3, q: "Sensation = ?", a: "The IMMEDIATE RESPONSE of sensory receptors (eyes, ears, nose, mouth, skin) to basic stimuli (light, colour, sound, odour, texture)." },
  { s:3, q: "Perception vs Sensation?", a: "SENSATION = raw, immediate sensory response (input)\nPERCEPTION = selecting + organizing + interpreting that input (processing)" },
  { s:3, q: "Perceptual Process (Solomon, 2018)?", a: "Sensory stimuli -> Sensory receptors -> EXPOSURE -> ATTENTION -> INTERPRETATION\n(5 stages, in this exact order)" },
  { s:3, q: "Functional vs Symbolic Attributes?", a: "FUNCTIONAL = tangible, measurable (taste, price, weight, smell)\nSYMBOLIC = intangible (brand image, perceived quality, status, authenticity)" },
  { s:3, q: "Absolute Threshold vs Differential Threshold (JND)?", a: "ABSOLUTE = minimum stimulation DETECTED on a sensory channel\nDIFFERENTIAL (JND) = ability to detect CHANGES or DIFFERENCES between two stimuli" },
  { s:3, q: "What is Subliminal Perception?", a: "Stimuli BELOW the absolute threshold. Consumer is NOT consciously aware but behaviour may still be influenced." },
  { s:3, q: "Perceptual Vigilance vs Perceptual Defence?", a: "VIGILANCE = notice stimuli related to CURRENT NEEDS\nDEFENCE = BLOCK threatening or unpleasant stimuli (see what you want to see)" },
  { s:3, q: "Sensory Overload?", a: "Exposed to FAR MORE INFORMATION than can be processed. Common in multitasking environments." },
  { s:3, q: "Motivation = ?", a: "The process that leads people to BEHAVE AS THEY DO. Occurs when a NEED IS AROUSED that the consumer wishes to satisfy, creating TENSION that drives action." },
  { s:3, q: "Maslow's Hierarchy (5 levels)?", a: "Bottom to top:\n1) PHYSIOLOGICAL (food, water)\n2) SAFETY (security)\n3) BELONGINGNESS/Love\n4) ESTEEM (status, recognition)\n5) SELF-ACTUALIZATION" },
  { s:3, q: "3 Motivational Conflicts?", a: "1) APPROACH-APPROACH = 2 desirable options\n2) APPROACH-AVOIDANCE = product has + AND - qualities\n3) AVOIDANCE-AVOIDANCE = 2 undesirable options" },
  { s:3, q: "Approach-Avoidance conflict example?", a: "Wanting a chocolate cake (approach) but worrying about calories (avoidance). The product has BOTH positive and negative qualities." },
  { s:3, q: "Moods vs Emotions?", a: "MOODS = mild, diffuse, NO clear cause, last LONGER\nEMOTIONS = intense, specific, CLEAR CAUSE, SHORT-LIVED" },
  { s:3, q: "What is Affect?", a: "UMBRELLA TERM for moods + emotions. The experience of emotionally laden states." },
  // ===== SESSION 4: Market Study Phases (8) =====
  { s:4, q: "5 Stages of a Market Study?", a: "1. FORMULATE the problem\n2. DETERMINE study design\n3. DATA COLLECTION & sampling\n4. ANALYZE & interpret\n5. REPORT & delivery\n-> Make DECISIONS" },
  { s:4, q: "MDP vs MSP?", a: "MDP = what the decision maker needs to DO (ACTION-oriented, focuses on SYMPTOMS)\nMSP = what INFORMATION is needed (RESEARCH-oriented, focuses on UNDERLYING CAUSES)" },
  { s:4, q: "MDP example vs MSP example?", a: "MDP: 'Should Starbucks launch a drive-thru in France?'\nMSP: 'What are consumers beliefs, perceptions, motivations towards a drive-thru?'" },
  { s:4, q: "Brief vs Proposal?", a: "BRIEF = from the CLIENT (background, objectives, scope, budget, timing)\nPROPOSAL = from the SUPPLIER/RESEARCH INSTITUTE (methodology, sample, timeline, budget, ethics)" },
  { s:4, q: "Exploratory vs Conclusive Study?", a: "EXPLORATORY = insights, understanding, flexible, unstructured, small sample, qualitative\nCONCLUSIVE = test hypotheses, examine relationships, structured, large sample, quantitative" },
  { s:4, q: "Descriptive Study = ?", a: "Type of CONCLUSIVE study. DESCRIBES market characteristics: user profiles, percentages of behaviours, triggers. It is EXPLANATORY." },
  { s:4, q: "Causal Study = ?", a: "Type of CONCLUSIVE study. Evidence of CAUSE-AND-EFFECT relationships. Does X (cause) influence Y (effect)? It is CONFIRMATORY." },
  { s:4, q: "3 Study Design Types and their purpose?", a: "1) EXPLORATORY (qualitative) = understand, explore\n2) DESCRIPTIVE (quantitative) = describe, measure, explain\n3) CAUSAL (quantitative) = confirm cause-effect relationships" },
  // ===== SESSION 5: Secondary Data (5) =====
  { s:5, q: "Primary vs Secondary Data?", a: "PRIMARY = collected FOR this study (expensive, slow, very involved)\nSECONDARY = already EXISTS, collected for other purposes (cheap, fast, prerequisite)" },
  { s:5, q: "Key rule about Secondary Data?", a: "Examination of secondary data is a PREREQUISITE to primary data collection. A market study ALWAYS starts with secondary data." },
  { s:5, q: "Internal vs External Secondary Data?", a: "INTERNAL = within organization (client database, CRM/ERP, internal reports)\nEXTERNAL = outside (government/census, professional associations, press, social media, syndicated services)" },
  { s:5, q: "3 Sieves of Socrates?", a: "For evaluating secondary data:\n1) Is it TRUE?\n2) Is it GOOD?\n3) Is it USEFUL?\nAlso check: methodology, accuracy, currency, content, purpose, credibility." },
  { s:5, q: "Uses of Secondary Data?", a: "Identify the problem, better define it, develop approach, formulate research design, answer study questions, interpret primary data more insightfully." },
  // ===== SESSION 6: Qualitative Study (10) =====
  { s:6, q: "Qualitative Study = ?", a: "UNSTRUCTURED, EXPLORATORY methodology. SMALL samples. Provides INSIGHT and UNDERSTANDING. Focus on WORDS, concepts, ideas, opinions. Data is NON-NUMERICAL." },
  { s:6, q: "Qualitative Study Procedures?", a: "DIRECT (nondisguised): Focus Groups, Depth Interviews\nINDIRECT (disguised): Projective Techniques" },
  { s:6, q: "Advantages of Qualitative Study?", a: "- Deeper insights than secondary data\n- Uncover UNDERLYING REASONS\n- Probe for motivations\n- Free exchange of information\n- Attribute responses to respondents" },
  { s:6, q: "Disadvantages of Qualitative Study?", a: "- Skilled interviewers are EXPENSIVE\n- SMALL sample = not conclusive\n- Quality depends on INTERVIEWER" },
  { s:6, q: "Depth Interview = ?", a: "DIRECT, PERSONAL, ONE-TO-ONE interview. Skilled interviewer probes for underlying opinions, motivations, beliefs, attitudes, feelings. Duration: 30 min to 1 hour." },
  { s:6, q: "Saturation Effect = ?", a: "When NO NEW insights, ideas, or patterns emerge as you interview more participants. Signals the END of interviews. Sample size CANNOT be known beforehand." },
  { s:6, q: "3 Interview Techniques?", a: "1) STRUCTURED = fixed questions, fixed order\n2) SEMI-STRUCTURED = set topics, FLEXIBLE order, follow-ups allowed\n3) NARRATIVE = open-ended, respondent tells story" },
  { s:6, q: "Interview Guide (4 phases)?", a: "1) INTRODUCTORY (build trust, explain purpose)\n2) SUBJECT CENTERING (main topic)\n3) DEEPENING (probe deeper)\n4) CLOSING (thank, remind confidentiality)" },
  { s:6, q: "3 Question Types in Interview Guide?", a: "1) DESCRIPTIVE = ask for FACTS\n2) CASUAL = ask for REASONS (why?)\n3) CONSEQUENCE = ask what HAPPENS as a result" },
  { s:6, q: "Interviewer: Do's vs Don'ts?", a: "DO: listen actively, stay objective, show understanding, make summaries, record\nDON'T: fear silence, interrupt, be directive, induce responses, interpret, give opinions" },
  // ===== SESSION 8: Qualitative Analysis (7) =====
  { s:8, q: "Thematic Analysis = ?", a: "Delving through data, IDENTIFYING PATTERNS, systematically CODING, deriving THEMES, creating a NARRATIVE." },
  { s:8, q: "7 Steps of Qualitative Analysis?", a: "1) Familiarize with data\n2) Initial codes\n3) Decide what to code\n4) Merge codes with excerpts (CODIFYING)\n5) Group codes into THEMES\n6) Assess & revise themes\n7) Write results" },
  { s:8, q: "Excerpt vs Code vs Theme?", a: "EXCERPT = word-for-word verbatim\nCODE = word/phrase capturing essence of excerpt\nTHEME = grouping of codes that says something meaningful about the MSP" },
  { s:8, q: "What is Codifying?", a: "GROUPING and CATEGORIZING data by codes to CONSOLIDATE MEANING and explanation. Step 4 of thematic analysis." },
  { s:8, q: "Hierarchy: Excerpt -> Code -> ... -> ?", a: "Transcript -> EXCERPT -> CODE -> SUB-THEME -> THEME -> NARRATIVE" },
  { s:8, q: "Strong vs Weak Themes?", a: "STRONG = most recurring (high frequency of excerpts, many respondents)\nWEAK = less recurring\nDepends on: frequency, # of interviews, length of verbatim" },
  { s:8, q: "Can qualitative findings be generalized?", a: "NO. Sample too small, not statistically representative. BUT they provide INSIGHTS, better UNDERSTANDING, and help DESIGN THE QUESTIONNAIRE for quantitative phase." },
  // ===== SESSION 9: Quantitative Study (12) =====
  { s:9, q: "Quantitative Study = ?", a: "SYSTEMATIC investigation by gathering QUANTIFIABLE data + statistical techniques. It is EXPLANATORY (descriptive) and CONFIRMATORY (causal). Confirms relationships between variables." },
  { s:9, q: "Qualitative vs Quantitative - Key Table?", a: "QUAL: small sample, unstructured, non-statistical, initial understanding\nQUANT: large sample, structured, statistical, recommend final course of action" },
  { s:9, q: "Quantitative Data = ?", a: "Information that can be COUNTED or MEASURED with NUMERICAL value. Either intrinsically quantitative (income) or IMPOSED numeric structure (Likert scale 1-5)." },
  { s:9, q: "Sampling Design Process (3 steps)?", a: "1) DEFINE the population (+ deduce target)\n2) CHOOSE the sampling METHOD\n3) DETERMINE the sample SIZE" },
  { s:9, q: "Population vs Sample?", a: "POPULATION = defined group from which sample is drawn\nSAMPLE = members selected to participate\nProper sampling -> estimate population characteristics" },
  { s:9, q: "When Probability vs Non-probability?", a: "Sampling frame AVAILABLE -> PROBABILITY sampling\nSampling frame NOT available -> NON-PROBABILITY sampling" },
  { s:9, q: "3 Probability Sampling Methods?", a: "1) SIMPLE RANDOM = equal probability for each member\n2) STRATIFIED RANDOM = divide into subgroups (strata), random from each\n3) CLUSTER = identify geographic clusters, sample from those" },
  { s:9, q: "4 Non-probability Sampling Methods?", a: "1) CONVENIENCE = haphazard\n2) PURPOSIVE = researcher's judgment\n3) SNOWBALL = participants recruit others\n4) QUOTA = sample reflects population subgroup composition" },
  { s:9, q: "Quota Sampling?", a: "Most used non-probability method in marketing. Sample MIRRORS POPULATION STRUCTURE on key criteria (age, gender...). Reduces lack of representativeness." },
  { s:9, q: "Single vs Cross Quota?", a: "SINGLE = 1 criterion (e.g., gender)\nCROSS = 2+ criteria crossed (e.g., gender x age)\nToo many criteria (>2-3) = hard to find respondents" },
  { s:9, q: "Sample Size Formula?", a: "n = tÂ²pq / eÂ²\nt=1.96 (95% confidence), p=q=0.5\nSimplified: n = 1/eÂ²\ne=4% -> n=600 | e=2% -> n=2401" },
  { s:9, q: "Margin of Error & Sample Size Rule?", a: "To HALVE the margin of error: QUADRUPLE the sample size.\ne/2 -> n x 4\nHuge consequences on COST and TIME." }
];

const quizQuestions = [
  // SESSION 1 (3)
  { s:1, q: "What is the role of a market study?", options: ["Only to collect data for competitors", "Assessing info needs, providing relevant info, and helping management make decisions", "Only to create advertising campaigns", "To replace management decision-making"], correct: 1, explanation: "A market study has 3 roles: assessing information needs, providing relevant information, and helping management make informed decisions. (Session 1)" },
  { s:1, q: "Which of the following is NOT part of the definition of consumer behaviour?", options: ["Select and purchase products", "Dispose of products or experiences", "Setting the price of products", "Satisfying needs and desires"], correct: 2, explanation: "Consumer behaviour involves selecting, purchasing, using, and disposing of products to satisfy needs. Setting prices is a marketing decision, not consumer behaviour. (Session 1)" },
  { s:1, q: "A market study is described as:", options: ["A subjective and creative process", "The systematic and objective identification, collection, analysis and use of information", "A simple customer satisfaction survey", "An advertising campaign evaluation"], correct: 1, explanation: "A market study is the systematic and objective identification, collection, analysis, dissemination, and use of information for decision making. (Session 1)" },
  // SESSION 2 (6)
  { s:2, q: "What is the correct definition of 'behaviour' in consumer studies?", options: ["A consumer's overall evaluation of a product", "The cognitive information a consumer holds about an object", "An observed and factual action toward an object", "The process of interpreting sensory information"], correct: 2, explanation: "Behaviour is observed and factual - it is what a consumer actually does. (Session 2)" },
  { s:2, q: "In the consumer behaviour model, what are the two components of the 'Consumer's Black Box'?", options: ["Marketing stimuli and other stimuli", "Consumer characteristics and decision process", "Attitudes and purchase behaviour", "Perception and motivation"], correct: 1, explanation: "The black box contains consumer characteristics and the decision process. (Session 2)" },
  { s:2, q: "The 3 components of attitude (ABC model) are:", options: ["Awareness, Behaviour, Consumption", "Cognition, Affect, Intention to act (Conation)", "Analysis, Belief, Choice", "Cost, Availability, Brand"], correct: 1, explanation: "The ABC model: Cognition (what you know), Affect (what you feel), Conation/Intention to act (what you intend to do). (Session 2)" },
  { s:2, q: "In classical conditioning, attitudes are formed by:", options: ["Rewards and punishments", "Pairing a neutral stimulus with a stimulus that naturally elicits a response", "Direct personal interaction with the product", "Reading product reviews online"], correct: 1, explanation: "Classical conditioning pairs a neutral stimulus with one that naturally elicits a response, until the neutral stimulus alone triggers the response. (Session 2)" },
  { s:2, q: "Beliefs are:", options: ["Easy to change with a single advertisement", "Resistant to change and can be positive, neutral, or negative", "Always factually correct", "The same as attitudes"], correct: 1, explanation: "Beliefs are cognitive information, resistant to change, and can be positive, neutral, or negative. They are not the same as attitudes. (Session 2)" },
  { s:2, q: "Consumer personal characteristics include:", options: ["Age, lifestyle, personality", "Only income and education", "Only culture and social class", "Marketing stimuli"], correct: 0, explanation: "Personal characteristics include age, lifestyle, and personality. Income/education are also personal but the most complete answer includes age, lifestyle, personality. (Session 2)" },
  // SESSION 3 (8)
  { s:3, q: "What is 'perception' according to the course?", options: ["The immediate response of sensory receptors to stimuli", "The process by which sensory information is selected, organized, and interpreted", "A consumer's overall feeling about a product", "The act of purchasing a product"], correct: 1, explanation: "Perception is the process of selecting, organizing, and interpreting sensory info. Option a) is the definition of 'sensation.' (Session 3)" },
  { s:3, q: "What is the correct order of the perceptual process (Solomon, 2018)?", options: ["Attention > Exposure > Interpretation > Sensory stimuli", "Sensory stimuli > Sensory receptors > Exposure > Attention > Interpretation", "Interpretation > Attention > Exposure > Sensory receptors", "Sensory receptors > Motivation > Attention > Behaviour"], correct: 1, explanation: "Stimuli > Receptors > Exposure > Attention > Interpretation. (Session 3)" },
  { s:3, q: "The absolute threshold is:", options: ["The ability to detect differences between two stimuli", "The minimum amount of stimulation detected on a sensory channel", "The maximum amount of sensory input a person can handle", "The point where subliminal messages become conscious"], correct: 1, explanation: "Absolute threshold is the minimum amount of stimulation that can be detected on a sensory channel. The differential threshold (JND) detects differences. (Session 3)" },
  { s:3, q: "Subliminal perception refers to:", options: ["Stimuli that are very loud and obvious", "Stimuli below the level of conscious awareness that may still influence behaviour", "A marketing strategy using bright colors", "Perception through taste only"], correct: 1, explanation: "Subliminal perception: stimuli fall below the absolute threshold, so the consumer is not consciously aware, but they may still influence behaviour. (Session 3)" },
  { s:3, q: "Which is a limitation of Maslow's hierarchy of needs?", options: ["It has too few levels", "The order of needs is always strictly followed by all individuals", "It is culture-specific and the hierarchy may not apply universally", "It only applies to children"], correct: 2, explanation: "Maslow's hierarchy is criticized for being culture-specific. The strict order may not apply universally - some people may prioritize esteem over belongingness. (Session 3)" },
  { s:3, q: "In an approach-avoidance motivational conflict, a consumer:", options: ["Must choose between two equally desirable options", "Wants a product but it also has negative aspects", "Must choose between two equally undesirable options", "Has no conflict at all"], correct: 1, explanation: "Approach-avoidance: the product has both positive and negative qualities. E.g., wanting a dessert (approach) but worrying about calories (avoidance). (Session 3)" },
  { s:3, q: "The difference between moods and emotions is:", options: ["There is no difference", "Moods are intense and specific; emotions are mild and diffuse", "Moods are mild and diffuse; emotions are intense and specific with a clear cause", "Moods last only seconds while emotions last days"], correct: 2, explanation: "Moods: mild, diffuse, no clear cause, last longer. Emotions: intense, specific, clearly identified cause, short-lived. (Session 3)" },
  { s:3, q: "'Brand image' and 'perceived quality' are examples of:", options: ["Functional attributes", "Symbolic attributes", "Primary data", "Sampling methods"], correct: 1, explanation: "Brand image and perceived quality are symbolic (intangible) attributes. Functional attributes are tangible like price, weight, taste. (Session 3)" },
  // SESSION 4 (5)
  { s:4, q: "The Management Decision Problem (MDP) asks:", options: ["What information is needed and how to obtain it", "What the decision maker needs to do", "How to analyze the data collected", "Who should conduct the study"], correct: 1, explanation: "The MDP asks what the decision maker needs to do (action-oriented). The MSP asks what information is needed (research-oriented). (Session 4)" },
  { s:4, q: "A 'brief' in the market study process comes from:", options: ["The research institute", "The government", "The client", "The consumers"], correct: 2, explanation: "The brief is from the client. The proposal is from the supplier/research institute. (Session 4)" },
  { s:4, q: "A descriptive study is used to:", options: ["Provide insights and initial understanding", "Describe market characteristics, estimate percentages, and determine triggers", "Test only cause-and-effect relationships", "Replace the need for a qualitative study"], correct: 1, explanation: "Descriptive study = describe market characteristics (e.g., user profiles, percentages exhibiting a behaviour, determining triggers). It is a type of conclusive study. (Session 4)" },
  { s:4, q: "A causal study aims to:", options: ["Describe the characteristics of respondents", "Obtain evidence regarding cause-and-effect relationships between variables", "Provide insights and understanding only", "Collect secondary data"], correct: 1, explanation: "Causal study = obtain evidence regarding cause-and-effect (causal) relationships. E.g., does X (cause) influence Y (effect)? (Session 4)" },
  { s:4, q: "In the Starbucks case, which study design is needed to identify the triggers that impact attitude and behaviour?", options: ["Exploratory study only", "Descriptive study only", "Causal/confirmatory study (quantitative via survey)", "No study is needed"], correct: 2, explanation: "Identifying triggers that impact attitude and behaviour requires a causal/confirmatory study using a quantitative survey. (Session 4)" },
  // SESSION 5 (4)
  { s:5, q: "Secondary data is:", options: ["Data collected specifically for the current study", "Data collected for some other purpose than the problem at hand", "Data that is always unreliable", "Data from depth interviews"], correct: 1, explanation: "Secondary data was collected for a different purpose. It is existing data and a prerequisite to primary data collection. (Session 5)" },
  { s:5, q: "Which of the following is NOT a characteristic of secondary data compared to primary data?", options: ["Relatively low cost", "Short collection time", "Very involved collection process", "Rapid and easy collection"], correct: 2, explanation: "'Very involved' describes primary data, not secondary data. Secondary data is rapid, easy, low cost, short time. (Session 5)" },
  { s:5, q: "Which is NOT a use of secondary data?", options: ["Identify and better define the problem", "Interpret primary data more insightfully", "Replace all need for primary data collection", "Formulate an appropriate research design"], correct: 2, explanation: "Secondary data helps identify/define problems, develop approaches, formulate designs, and interpret primary data - but it does NOT replace primary data. (Session 5)" },
  { s:5, q: "Internal secondary data includes:", options: ["Government census data", "Professional press articles", "Client database, CRM/ERP, internal reports", "Syndicated services from external providers"], correct: 2, explanation: "Internal data = within the organization (client database, CRM/ERP, internal reports, previous studies). The others are external sources. (Session 5)" },
  // SESSION 6 (6)
  { s:6, q: "A qualitative study focuses on:", options: ["Numerical data and statistical tests", "Words, concepts, ideas, and opinions", "Large, representative samples", "Confirming hypotheses"], correct: 1, explanation: "Qualitative study focuses on words, concepts, ideas, and opinions. It is non-numerical. (Session 6)" },
  { s:6, q: "The 'saturation effect' in qualitative research means:", options: ["The interviewer is too tired to continue", "You stop finding new insights as you interview more participants", "The sample size has reached 100 respondents", "All respondents give the same demographic profile"], correct: 1, explanation: "Saturation = no new insights, ideas, or patterns emerge. This signals the end of interviews. (Session 6)" },
  { s:6, q: "In a semi-structured interview, the interviewer:", options: ["Follows a strict order of pre-determined questions", "Does not impose a specific sequence and can ask follow-up questions", "Only listens and never asks questions", "Uses a questionnaire with closed-ended questions"], correct: 1, explanation: "Semi-structured: topics/questions are set, but no imposed sequence. Free to ask additional questions. (Session 6)" },
  { s:6, q: "The interview guide is structured in:", options: ["2 phases: introduction and conclusion", "4 phases: introductory, subject centering, deepening, closing", "6 phases matching the market study process", "No specific structure is needed"], correct: 1, explanation: "The interview guide has 4 phases: introductory (build trust), subject centering, deepening, and closing (thank respondent). (Session 6)" },
  { s:6, q: "Which type of question asks for reasons behind a behaviour or opinion?", options: ["Descriptive question", "Casual question", "Consequence question", "Closed-ended question"], correct: 1, explanation: "Casual questions ask for reasons why a behaviour/opinion exists. Descriptive questions ask for facts. Consequence questions ask what happens as a result. (Session 6)" },
  { s:6, q: "During an interview, the interviewer should NOT:", options: ["Listen actively and stay objective", "Fear silence and interrupt the interviewee", "Show understanding without interpretation", "Record the interview and take notes"], correct: 1, explanation: "The interviewer should NOT fear silence, interrupt, be directive, induce responses, interpret, or give opinions/judgments. (Session 6)" },
  // SESSION 8 (5)
  { s:8, q: "In thematic analysis, a 'code' is:", options: ["A full paragraph from the transcript", "A word or short phrase that captures the essence of an excerpt", "The name of a respondent", "A statistical formula"], correct: 1, explanation: "A code is a word or short phrase that symbolically assigns a summative, essence-capturing attribute to an excerpt. (Session 8)" },
  { s:8, q: "Which is the correct hierarchy in thematic analysis?", options: ["Theme > Code > Excerpt > Narrative", "Narrative > Theme > Excerpt > Code", "Excerpt > Code > Theme > Narrative", "Code > Excerpt > Narrative > Theme"], correct: 2, explanation: "Transcript > Excerpts > Codes > Themes > Narrative. (Session 8)" },
  { s:8, q: "'Codifying' in thematic analysis means:", options: ["Recording the interviews", "Grouping and categorizing data by codes to consolidate meaning", "Writing the final report", "Selecting participants for interviews"], correct: 1, explanation: "Codifying = grouping and categorizing data by codes to consolidate meaning and explanation. (Session 8)" },
  { s:8, q: "Step 6 of qualitative analysis (assess and revise themes) requires:", options: ["Deleting all themes and starting over", "Checking relevance, ensuring enough data per theme, merging similar themes", "Only adding more themes", "Sending themes to respondents for validation"], correct: 1, explanation: "Step 6: evaluate relevance, ensure enough data per theme, themes must be mutually exclusive. Merge similar ones, delete non-contributing ones. Iterative process. (Session 8)" },
  { s:8, q: "Strong themes depend on:", options: ["The researcher's personal opinion only", "Frequency of excerpts, number of interviews addressing the code, and length of verbatim", "The number of pages in the transcript", "Whether the theme has a catchy name"], correct: 1, explanation: "Strong themes = most recurring content based on frequency of excerpts, number of respondents addressing the idea, and length of verbatim. (Session 8)" },
  // SESSION 9 (8)
  { s:9, q: "Quota sampling is a type of:", options: ["Probability sampling", "Non-probability sampling", "Cluster sampling", "Stratified sampling"], correct: 1, explanation: "Quota sampling is a non-probability sampling method where the sample reflects the numerical composition of subgroups. (Session 9)" },
  { s:9, q: "The main difference between a quantitative and qualitative study outcome is:", options: ["Qualitative recommends a final course of action, quantitative develops initial understanding", "Qualitative develops initial understanding, quantitative recommends a final course of action", "Both aim to develop initial understanding", "Both recommend a final course of action"], correct: 1, explanation: "Qualitative = develop initial understanding. Quantitative = recommend a final course of action. (Session 9)" },
  { s:9, q: "When should you use probability sampling?", options: ["When you have no sampling frame available", "When a sampling frame representing the target population is available and accessible", "When the study is qualitative", "When the budget is very limited"], correct: 1, explanation: "Probability sampling is used when a sampling frame (list of the target population) is available and accessible. (Session 9)" },
  { s:9, q: "The difference between single quota and cross quota sampling is:", options: ["There is no difference", "Single quota uses one criterion; cross quota crosses two or more criteria", "Single quota is probability sampling; cross quota is not", "Cross quota uses only one criterion"], correct: 1, explanation: "Single quota: one criterion (e.g., gender). Cross quota: two or more crossed criteria (e.g., gender x age). Too many (>2-3) makes it difficult. (Session 9)" },
  { s:9, q: "If you want to halve the margin of error (e.g., from 4% to 2%), you need to:", options: ["Double the sample size", "Quadruple the sample size", "Keep the same sample size", "Halve the sample size"], correct: 1, explanation: "To double precision (halve e), you must quadruple the sample size: e/2 -> n x 4. E.g., e=4% n=600 vs e=2% n=2401. (Session 9)" },
  { s:9, q: "A confidence interval is:", options: ["The exact population value", "An interval of values within which there is a given level of confidence the population value lies", "The margin of error only", "The sample size formula"], correct: 1, explanation: "A confidence interval is an interval of values within which there is a given level of confidence that the population value lies. (Session 9)" },
  { s:9, q: "An advantage of quota sampling over other non-probability methods is:", options: ["It is a probability sampling technique", "It reduces the drawback of lack of representativeness by matching population structure", "It requires no knowledge of the population structure", "It is always free of bias"], correct: 1, explanation: "Quota sampling reduces the drawbacks of non-probability sampling (lack of representativeness) by ensuring the sample mirrors the population structure on key criteria. (Session 9)" },
  { s:9, q: "The population in a market study is:", options: ["Only the people who respond to the survey", "The defined group of individuals from which a sample is drawn", "Always the entire country's population", "The same as the sample"], correct: 1, explanation: "The population is the defined group of individuals from which a sample is drawn. The sample is a subset selected to participate. (Session 9)" },
  // ADDITIONAL HIGH-YIELD QUESTIONS
  { s:2, q: "In operant (instrumental) conditioning, attitudes are shaped by:", options: ["Pairing a neutral stimulus with an unconditioned stimulus", "Rewards and punishments following a behaviour", "Personal direct experience with the product", "Subliminal messages"], correct: 1, explanation: "Operant/instrumental conditioning: attitudes are formed through rewards (positive reinforcement) and punishments. Classical conditioning uses pairing of stimuli. (Session 2)" },
  { s:3, q: "Murray's psychogenic needs include categories such as:", options: ["Physiological, safety, and love needs", "Ambition, materialism, power, affection, information, and snobbery", "Only achievement and affiliation needs", "The 5 levels of Maslow's hierarchy"], correct: 1, explanation: "Murray identified 6 categories of psychogenic needs: ambition, materialism, power, affection, information, and snobbery. These differ from Maslow's hierarchy. (Session 3)" },
  { s:4, q: "The first stage of the market study process is:", options: ["Determine the study design", "Data collection and sampling", "Formulate the problem (MDP + MSP)", "Report preparation and delivery"], correct: 2, explanation: "Stage 1 is formulating the problem, which includes defining the MDP (Management Decision Problem) and MSP (Marketing Study Problem). (Session 4)" },
  { s:6, q: "In qualitative research, sampling techniques include:", options: ["Simple random, stratified, and cluster sampling", "Convenience, purposive, and snowball sampling", "Quota sampling only", "Cross-quota and single-quota sampling"], correct: 1, explanation: "Qualitative research uses convenience, purposive, and snowball sampling. Probability methods (simple random, stratified, cluster) require a sampling frame. Quota sampling is for quantitative studies. (Session 6)" },
  { s:9, q: "For a non-probability sampling technique at national scope (general public), the recommended sample size is:", options: ["50 to 100 respondents", "300 to 600 respondents", "1000 to 2000 respondents", "Over 5000 respondents"], correct: 2, explanation: "For non-probability sampling, general public at national scope: n = 1000 to 2000. At city scope: n = 300 to 600. (Session 9)" }
];

// ===== STATE =====
let currentMode = 'study';
let currentSession = 'all';
let fcIndex = 0;
let fcFilterSession = 'all';
let filteredFlashcards = [...Array(flashcards.length).keys()];
let fcOrder = [...filteredFlashcards];
let quizAnswers = {};
let quizScore = 0;
let sessionsRead = new Set();
let currentQuizMode = null;
let activeQuizQuestions = [];
let timerInterval = null;
let timerSeconds = 0;
let masteredCards = new Set();
let quizHistory = [];

// Load from localStorage
try {
  const saved = localStorage.getItem('ca1_progress');
  if (saved) sessionsRead = new Set(JSON.parse(saved));
  const savedTheme = localStorage.getItem('ca1_theme');
  if (savedTheme === 'dark') document.documentElement.setAttribute('data-theme', 'dark');
  const savedMastered = localStorage.getItem('ca1_mastered');
  if (savedMastered) masteredCards = new Set(JSON.parse(savedMastered));
  const savedHistory = localStorage.getItem('ca1_quiz_history');
  if (savedHistory) quizHistory = JSON.parse(savedHistory);
} catch(e) {}

// ===== THEME =====
function toggleTheme() {
  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
  document.documentElement.setAttribute('data-theme', isDark ? '' : 'dark');
  localStorage.setItem('ca1_theme', isDark ? '' : 'dark');
}

// ===== MODES =====
function switchMode(mode) {
  currentMode = mode;
  document.querySelectorAll('.mode-btn').forEach(b => b.classList.toggle('active', b.dataset.mode === mode));
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.getElementById(mode + 'Section').classList.add('active');
  document.getElementById('navTabs').style.display = (mode === 'study') ? 'flex' : 'none';
  if (mode === 'flashcards') { updateMasteryCounter(); showCard(); }
  if (mode === 'quiz') backToModeSelect();
}

// ===== SESSION TOGGLE =====
function toggleSession(header) {
  const card = header.closest('.session-card');
  card.classList.toggle('open');
  const sessionNum = card.dataset.session;
  if (card.classList.contains('open')) {
    sessionsRead.add(sessionNum);
    localStorage.setItem('ca1_progress', JSON.stringify([...sessionsRead]));
    updateProgress();
  }
}

// ===== FILTER SESSIONS =====
function filterSession(session) {
  currentSession = session;
  document.querySelectorAll('.nav-tab').forEach((t, i) => {
    if (session === 'all') t.classList.toggle('active', i === 0);
    else t.classList.toggle('active', t.textContent.includes('S' + session));
  });
  document.querySelectorAll('.session-card').forEach(card => {
    if (session === 'all') card.classList.remove('hidden');
    else card.classList.toggle('hidden', card.dataset.session !== String(session));
  });
  if (session !== 'all') {
    document.querySelectorAll('.session-card').forEach(card => {
      if (card.dataset.session === String(session)) card.classList.add('open');
    });
  }
}

// ===== SEARCH =====
function handleSearch(query) {
  const q = query.toLowerCase().trim();
  if (!q) { document.querySelectorAll('.session-card').forEach(c => c.classList.remove('hidden')); return; }
  document.querySelectorAll('.session-card').forEach(card => {
    const match = card.textContent.toLowerCase().includes(q);
    card.classList.toggle('hidden', !match);
    if (match) card.classList.add('open');
  });
}

// ===== PROGRESS =====
function updateProgress() {
  const total = 8; const read = sessionsRead.size;
  const pct = Math.round((read / total) * 100);
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressText').textContent = pct + '%';
}
updateProgress();

// ===== FLASHCARDS =====
function filterFlashcards(session) {
  fcFilterSession = session;
  document.querySelectorAll('#fcFilterRow .fc-filter-btn').forEach(b => {
    if (session === 'all') b.classList.toggle('active', b.textContent === 'All');
    else if (session === 'notmastered') b.classList.toggle('active', b.classList.contains('mastered-filter'));
    else b.classList.toggle('active', b.textContent === 'S' + session);
  });
  if (session === 'all') filteredFlashcards = [...Array(flashcards.length).keys()];
  else if (session === 'notmastered') {
    filteredFlashcards = []; flashcards.forEach((c, i) => { if (!masteredCards.has(i)) filteredFlashcards.push(i); });
  } else {
    filteredFlashcards = []; flashcards.forEach((c, i) => { if (c.s === session) filteredFlashcards.push(i); });
  }
  fcOrder = [...filteredFlashcards]; fcIndex = 0; showCard();
}

function showCard() {
  if (fcOrder.length === 0) {
    document.getElementById('fcQuestion').textContent = fcFilterSession === 'notmastered' ? 'All cards mastered!' : 'No cards for this filter';
    document.getElementById('fcAnswer').textContent = '';
    document.getElementById('fcProgress').textContent = '0 / 0';
    document.getElementById('fcBadge').textContent = '';
    return;
  }
  const idx = fcOrder[fcIndex]; const card = flashcards[idx];
  document.getElementById('fcQuestion').textContent = card.q;
  document.getElementById('fcAnswer').textContent = card.a;
  document.getElementById('flashcard').classList.remove('flipped');
  document.getElementById('fcProgress').textContent = (fcIndex + 1) + ' / ' + fcOrder.length;
  document.getElementById('fcBadge').textContent = 'S' + card.s;
}

function flipCard() { document.getElementById('flashcard').classList.toggle('flipped'); }
function nextCard() { if (fcOrder.length === 0) return; fcIndex = (fcIndex + 1) % fcOrder.length; showCard(); }
function prevCard() { if (fcOrder.length === 0) return; fcIndex = (fcIndex - 1 + fcOrder.length) % fcOrder.length; showCard(); }
function shuffleCards() {
  for (let i = fcOrder.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [fcOrder[i], fcOrder[j]] = [fcOrder[j], fcOrder[i]]; }
  fcIndex = 0; showCard();
}

function markCard(action) {
  if (fcOrder.length === 0) return;
  const idx = fcOrder[fcIndex];
  if (action === 'gotit') masteredCards.add(idx); else masteredCards.delete(idx);
  localStorage.setItem('ca1_mastered', JSON.stringify([...masteredCards]));
  updateMasteryCounter();
  if (fcOrder.length > 1) nextCard();
}

function updateMasteryCounter() {
  const el = document.getElementById('fcMastery');
  if (el) el.textContent = 'Mastered: ' + masteredCards.size + ' / ' + flashcards.length;
}

// ===== CHEAT SHEET FILTER =====
function filterCheatSheet(session) {
  document.querySelectorAll('#csFilterRow .fc-filter-btn').forEach(b => {
    if (session === 'all') b.classList.toggle('active', b.textContent === 'All');
    else b.classList.toggle('active', b.textContent === 'S' + session);
  });
  document.querySelectorAll('.cheat-card').forEach(card => {
    if (session === 'all') card.classList.remove('hidden');
    else card.classList.toggle('hidden', card.dataset.cs !== String(session));
  });
}

// ===== QUIZ =====
function shuffleArray(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; }
  return a;
}

function backToModeSelect() {
  stopTimer(); currentQuizMode = null; activeQuizQuestions = []; quizAnswers = {}; quizScore = 0;
  document.getElementById('quizModeSelector').classList.remove('hidden');
  document.getElementById('quizSessionFilter').classList.add('hidden');
  document.getElementById('quizHeader').classList.add('hidden');
  document.getElementById('quizContainer').innerHTML = '';
  document.getElementById('quizResults').classList.remove('show');
  document.getElementById('quizTimer').classList.add('hidden-timer');
}

function startQuizMode(mode) {
  currentQuizMode = mode; quizAnswers = {}; quizScore = 0;
  if (mode === 'session') {
    document.getElementById('quizModeSelector').classList.add('hidden');
    document.getElementById('quizSessionFilter').classList.remove('hidden');
    return;
  }
  let indices = [...Array(quizQuestions.length).keys()];
  if (mode === 'quick10') { activeQuizQuestions = shuffleArray(indices).slice(0, 10); }
  else if (mode === 'exam') { activeQuizQuestions = shuffleArray(indices).slice(0, 15); }
  else { activeQuizQuestions = indices; }
  document.getElementById('quizModeSelector').classList.add('hidden');
  document.getElementById('quizSessionFilter').classList.add('hidden');
  document.getElementById('quizHeader').classList.remove('hidden');
  const titles = { quick10: 'Quick 10', exam: 'Exam Simulation (15 min)', full: 'Full Practice' };
  document.getElementById('quizTitle').textContent = titles[mode] || 'Quiz';
  if (mode === 'exam') { document.getElementById('quizTimer').classList.remove('hidden-timer'); startTimer(15 * 60); }
  else { document.getElementById('quizTimer').classList.add('hidden-timer'); }
  renderQuiz();
}

function startSessionQuiz(session) {
  activeQuizQuestions = [];
  quizQuestions.forEach((q, i) => { if (q.s === session) activeQuizQuestions.push(i); });
  if (activeQuizQuestions.length === 0) { alert('No questions for session ' + session); return; }
  document.getElementById('quizSessionFilter').classList.add('hidden');
  document.getElementById('quizHeader').classList.remove('hidden');
  document.getElementById('quizTitle').textContent = 'Session ' + session + ' Quiz';
  document.getElementById('quizTimer').classList.add('hidden-timer');
  quizAnswers = {}; quizScore = 0; renderQuiz();
}

function renderQuiz() {
  const container = document.getElementById('quizContainer');
  container.innerHTML = '';
  document.getElementById('quizResults').classList.remove('show');
  quizScore = 0; let answered = 0;
  activeQuizQuestions.forEach((qIdx, displayIdx) => {
    const q = quizQuestions[qIdx]; const div = document.createElement('div');
    div.className = 'question-card'; div.id = 'qcard-' + qIdx;
    const letters = ['A', 'B', 'C', 'D'];
    let optionsHtml = q.options.map((opt, oi) => {
      let cls = 'option'; const savedAnswer = quizAnswers[qIdx];
      if (savedAnswer !== undefined) { cls += ' disabled'; if (oi === q.correct) cls += ' correct'; if (oi === savedAnswer && savedAnswer !== q.correct) cls += ' wrong'; }
      return '<div class="' + cls + '" onclick="selectOption(' + qIdx + ',' + oi + ')" data-qi="' + qIdx + '" data-oi="' + oi + '"><div class="option-letter">' + letters[oi] + '</div><div>' + opt + '</div></div>';
    }).join('');
    const savedAnswer = quizAnswers[qIdx]; let expClass = 'explanation';
    if (savedAnswer !== undefined) { answered++; expClass += savedAnswer === q.correct ? ' correct-exp show' : ' wrong-exp show'; if (savedAnswer === q.correct) quizScore++; div.className += savedAnswer === q.correct ? ' answered-correct' : ' answered-wrong'; }
    div.innerHTML = '<div class="question-num">Question ' + (displayIdx + 1) + ' <span style="font-weight:400;opacity:0.6">(S' + q.s + ')</span></div><div class="question-text">' + q.q + '</div>' + optionsHtml + '<div class="' + expClass + '" id="exp-' + qIdx + '">' + q.explanation + '</div>';
    container.appendChild(div);
  });
  updateQuizScore(answered);
}

function selectOption(qi, oi) {
  if (quizAnswers[qi] !== undefined) return;
  quizAnswers[qi] = oi;
  const q = quizQuestions[qi]; const card = document.getElementById('qcard-' + qi);
  card.querySelectorAll('.option').forEach((opt, i) => { opt.classList.add('disabled'); if (i === q.correct) opt.classList.add('correct'); if (i === oi && oi !== q.correct) opt.classList.add('wrong'); });
  const exp = document.getElementById('exp-' + qi); exp.classList.add('show');
  if (oi === q.correct) { exp.classList.add('correct-exp'); card.classList.add('answered-correct'); quizScore++; }
  else { exp.classList.add('wrong-exp'); card.classList.add('answered-wrong'); }
  const answered = Object.keys(quizAnswers).length; updateQuizScore(answered);
  if (answered === activeQuizQuestions.length) { stopTimer(); showResults(); }
}

function updateQuizScore(answered) {
  const total = activeQuizQuestions.length;
  const pct = answered > 0 ? Math.round((quizScore / answered) * 100) : 0;
  document.getElementById('scoreText').textContent = pct + '%';
  document.getElementById('scoreCircle').style.background = 'conic-gradient(var(--primary) ' + (pct * 3.6) + 'deg, var(--border) ' + (pct * 3.6) + 'deg)';
  document.getElementById('quizProgress').textContent = answered + ' / ' + total + ' answered';
}

function showResults() {
  const total = activeQuizQuestions.length;
  const pct = Math.round((quizScore / total) * 100);
  const results = document.getElementById('quizResults');
  // Save history
  quizHistory.push({ mode: currentQuizMode || 'session', pct: pct });
  if (quizHistory.length > 10) quizHistory.shift();
  localStorage.setItem('ca1_quiz_history', JSON.stringify(quizHistory));
  const mistakes = activeQuizQuestions.filter(qi => quizAnswers[qi] !== quizQuestions[qi].correct).length;
  let msgText, subText;
  if (pct >= 80) { msgText = 'Excellent work!'; subText = 'You scored ' + quizScore + '/' + total + '. Well prepared for the CA1!'; }
  else if (pct >= 50) { msgText = 'Good effort!'; subText = 'You scored ' + quizScore + '/' + total + '. Review the ' + mistakes + ' question(s) you missed.'; }
  else { msgText = 'Keep studying!'; subText = 'You scored ' + quizScore + '/' + total + '. Go through the study material again.'; }
  let historyHtml = '';
  if (quizHistory.length > 1) historyHtml = '<div style="margin-top:16px;font-size:0.85em;color:var(--text-secondary)"><strong>Recent:</strong> ' + quizHistory.slice(-5).map(h => h.pct + '%').join(' â†’ ') + '</div>';
  results.innerHTML = '<div class="results-circle ' + (pct >= 80 ? 'great' : pct >= 50 ? 'ok' : 'bad') + '">' + pct + '%</div>' +
    '<div class="results-msg">' + msgText + '</div><div class="results-sub">' + subText + '</div>' + historyHtml +
    '<div style="display:flex;gap:10px;justify-content:center;margin-top:16px;flex-wrap:wrap">' +
    (mistakes > 0 ? '<button class="fc-btn" onclick="reviewMistakes()" style="border-color:var(--error);color:var(--error)">Review Mistakes</button>' : '') +
    '<button class="fc-btn primary-btn" onclick="backToModeSelect()">Back to Modes</button></div>';
  results.classList.add('show');
}

function reviewMistakes() {
  document.getElementById('quizResults').classList.remove('show');
  const first = activeQuizQuestions.find(qi => quizAnswers[qi] !== quizQuestions[qi].correct);
  if (first !== undefined) { const el = document.getElementById('qcard-' + first); if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
}

function resetQuiz() {
  quizAnswers = {}; quizScore = 0;
  document.getElementById('quizResults').classList.remove('show');
  if (currentQuizMode === 'exam') startTimer(15 * 60);
  renderQuiz();
}

// ===== TIMER =====
function startTimer(seconds) {
  stopTimer(); timerSeconds = seconds; updateTimerDisplay();
  timerInterval = setInterval(() => {
    timerSeconds--;
    if (timerSeconds <= 0) {
      stopTimer(); timerSeconds = 0; updateTimerDisplay();
      activeQuizQuestions.forEach(qi => {
        if (quizAnswers[qi] === undefined) {
          quizAnswers[qi] = -1; const card = document.getElementById('qcard-' + qi);
          if (card) { card.querySelectorAll('.option').forEach((opt, i) => { opt.classList.add('disabled'); if (i === quizQuestions[qi].correct) opt.classList.add('correct'); });
            const exp = document.getElementById('exp-' + qi); if (exp) exp.classList.add('show', 'wrong-exp'); card.classList.add('answered-wrong'); }
        }
      });
      showResults(); return;
    }
    updateTimerDisplay();
    if (timerSeconds <= 60) { document.getElementById('quizTimer').classList.add('warning'); if (navigator.vibrate && timerSeconds === 60) navigator.vibrate(200); }
  }, 1000);
}

function stopTimer() { if (timerInterval) { clearInterval(timerInterval); timerInterval = null; } document.getElementById('quizTimer').classList.remove('warning'); }

function updateTimerDisplay() {
  const m = Math.floor(timerSeconds / 60); const s = timerSeconds % 60;
  document.getElementById('timerDisplay').textContent = m + ':' + s.toString().padStart(2, '0');
}

// ===== RESET ALL =====
function resetAllProgress() {
  if (!confirm('Reset all progress? (mastered cards, quiz history, session progress)')) return;
  localStorage.removeItem('ca1_progress'); localStorage.removeItem('ca1_mastered'); localStorage.removeItem('ca1_quiz_history');
  sessionsRead = new Set(); masteredCards = new Set(); quizHistory = [];
  updateProgress(); updateMasteryCounter();
}

// ===== KEYBOARD =====
document.addEventListener('keydown', (e) => {
  if (currentMode === 'flashcards') {
    if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextCard(); }
    if (e.key === 'ArrowLeft') { e.preventDefault(); prevCard(); }
    if (e.key === 'Enter') { e.preventDefault(); flipCard(); }
  }
  if (currentMode === 'quiz') {
    const keyMap = { 'a': 0, 'b': 1, 'c': 2, 'd': 3 };
    const optIdx = keyMap[e.key.toLowerCase()];
    if (optIdx !== undefined) {
      const unanswered = activeQuizQuestions.find(qi => quizAnswers[qi] === undefined);
      if (unanswered !== undefined) { e.preventDefault(); selectOption(unanswered, optIdx);
        const next = activeQuizQuestions.find(qi => quizAnswers[qi] === undefined);
        if (next !== undefined) { const el = document.getElementById('qcard-' + next); if (el) setTimeout(() => el.scrollIntoView({ behavior: 'smooth', block: 'center' }), 300); }
      }
    }
  }
});

// ===== SWIPE =====
let touchStartX = 0, touchStartY = 0;
document.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; touchStartY = e.changedTouches[0].screenY; }, { passive: true });
document.addEventListener('touchend', (e) => {
  if (currentMode !== 'flashcards') return;
  const dx = e.changedTouches[0].screenX - touchStartX;
  const dy = e.changedTouches[0].screenY - touchStartY;
  if (Math.abs(dx) < 50 || Math.abs(dy) > Math.abs(dx)) return;
  if (dx > 0) prevCard(); else nextCard();
}, { passive: true });

// ===== BACK TO TOP =====
window.addEventListener('scroll', () => { const btn = document.getElementById('backToTop'); if (btn) btn.classList.toggle('visible', window.scrollY > 400); }, { passive: true });

// ===== INIT =====
updateMasteryCounter();
showCard();
</script>
</body>
</html>
